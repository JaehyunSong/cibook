<!DOCTYPE html>
<html lang="ja"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="宋財泫（関西大学）">
  <title>困菓唯倫 – 社会科学における因果推論</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-b6d722145684ebde2f4126fbe9a56250.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">社会科学における因果推論</h1>
  <p class="subtitle">4/ ランダム化比較試験</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
宋財泫（関西大学） 
</div>
</div>
</div>

</section>
<section>
<section id="内生性と外生性" class="title-slide slide level1 center">
<h1><strong>1</strong> 内生性と外生性</h1>

</section>
<section id="内生性" class="slide level2">
<h2>内生性</h2>
<p>処置変数と誤差項間に相関が存在する場合</p>
<ul>
<li>処置変数は<span class="alert">内生変数</span>（<span class="math inline">\(\Leftrightarrow\)</span>外生変数）</li>
<li>処置効果（因果効果）の推定値はバイアスを含む</li>
<li><span class="alert"><strong>内生性は因果推論の敵</strong></span></li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-3-1.png" width="1200"></p>
<figcaption>内生性あり</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-3-2.png" width="1200"></p>
<figcaption>内生性なし</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="内生性がない状態" class="slide level2">
<h2>内生性がない状態</h2>
<p>内生性が存在しない場合、処置群と統制群は集団として均質</p>
<ul>
<li>統制群と処置群を逆にしても問題ない（<span class="math inline">\(\Rightarrow\)</span>統制群と処置群は<strong>交換可能</strong>）</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-4-1.png" width="1200"></p>
<figcaption>例1）やる気のある学生が処置群に多い（内生性あり）</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-4-2.png" width="1200"></p>
<figcaption>例2）やる気のある学生の割合は処置群・統制群において均等（内生性なし）</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="交換可能性" class="slide level2">
<h2>交換可能性</h2>
<p><span class="alert"><strong>交換可能性</strong></span><span class="small">（exchangeability）</span>：処置と潜在的結果が独立であること</p>
<ul>
<li><span class="alert">無視可能性</span><span class="small">（ignorability）</span>、または<span class="alert">独立性</span><span class="small">（independence）</span>とも呼ばれる</li>
</ul>
<p><span class="math display">\[
(Y(0), Y(1)) \mathop{\perp\!\!\!\!\perp} D
\]</span></p>
<ul>
<li>処置群と統制群の潜在的結果の分布が同じであること
<ul>
<li>処置群と統制群が均質であるため、処置群を統制群に、統制群を処置群に<span class="alert"><strong>交換可能</strong></span></li>
</ul></li>
<li><span class="alert">交換可能性が成立する場合、ATEが推定可能</span></li>
</ul>

<img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center r-stretch" width="2400"></section>
<section id="平均独立性" class="slide level2">
<h2>平均独立性</h2>
<p><span class="alert"><strong>平均独立性</strong></span><span class="small">（mean independence）</span></p>
<p><span class="math display">\[
\begin{gathered}
\mathbb{E}[Y(0)|D = 1] = \mathbb{E}[Y(0)|D = 0] \\
\&amp; \\
\mathbb{E}[Y(1)|D = 1] = \mathbb{E}[Y(1)|D = 0]
\end{gathered}
\]</span></p>
<ul>
<li>潜在的結果の<ruby>分布<rt>・・</rt></ruby>でなく、<ruby><strong>期待値</strong><rt>・・・</rt></ruby>に関する条件：<span class="alert">交換可能性より緩い条件</span>
<ul>
<li><span class="alert">平均独立が成立していればATEは推定可能</span></li>
<li>ただし、不均一処置効果（HTE）を推定する場合、平均独立だけでは不十分<sup>1</sup>（交換可能性が必要）</li>
</ul></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>識別自体は可能だが、推定値が信頼できる推定値かは別の問題である。</p></li></ol></aside></section>
<section id="平均独立と交換可能性間の関係" class="slide level2">
<h2>平均独立と交換可能性間の関係</h2>
<p><strong><span class="alert">交換可能性は平均独立を内包する</span>より強い仮定</strong></p>
<ul>
<li>ただし、平均独立が交換可能性を保証するわけではない</li>
</ul>
<p><span class="math display">\[
\begin{gathered}
(Y(0), Y(1)) \mathop{\perp\!\!\!\!\perp} D \\
\Downarrow \\
\mathbb{E}[Y(0)|D = 1] = \mathbb{E}[Y(0)|D = 0] \\
\&amp; \\
\mathbb{E}[Y(1)|D = 1] = \mathbb{E}[Y(1)|D = 0]
\end{gathered}
\]</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">ケース</th>
<th style="text-align: left;">平均独立</th>
<th style="text-align: left;">交換可能性</th>
<th style="text-align: left;">ATE</th>
<th style="text-align: left;">HTE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: left;">成立</td>
<td style="text-align: left;">成立</td>
<td style="text-align: left;"><strong>識別可</strong></td>
<td style="text-align: left;"><strong>識別可</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: left;">成立</td>
<td style="text-align: left;">不成立</td>
<td style="text-align: left;"><strong>識別可</strong></td>
<td style="text-align: left;">識別不可</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: left;">不成立</td>
<td style="text-align: left;">成立</td>
<td style="text-align: left;">あり得ない</td>
<td style="text-align: left;">あり得ない</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: left;">不成立</td>
<td style="text-align: left;">不成立</td>
<td style="text-align: left;">識別不可</td>
<td style="text-align: left;">識別不可</td>
</tr>
</tbody>
</table>
</section>
<section id="平均独立と交換可能性" class="slide level2">
<h2>平均独立と交換可能性</h2>

<img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="2400"></section>
<section id="平均独立と交換可能性が成立する例" class="slide level2">
<h2>平均独立と交換可能性が成立する例</h2>
<p>真のATEが2の例</p>
<div class="columns">
<div class="column" style="width:35%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(D_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y_i(0)\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y_i(1)\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:65%;">
<ul>
<li>平均独立：成立
<ul>
<li><span class="math inline">\(\mathbb{E}[Y(0)|D = 1] = \mathbb{E}[Y(0)|D = 0] = 5\)</span></li>
<li><span class="math inline">\(\mathbb{E}[Y(1)|D = 1] = \mathbb{E}[Y(1)|D = 0] = 7\)</span></li>
</ul></li>
<li>交換可能性：成立（潜在的結果の分布が同じ）</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(Y(0)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y(1)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">統制群</td>
<td style="text-align: center;"><strong>[3, 7]</strong></td>
<td style="text-align: center;">[5, 9]</td>
</tr>
<tr class="even">
<td style="text-align: left;">処置群</td>
<td style="text-align: center;">[3, 7]</td>
<td style="text-align: center;"><strong>[5, 9]</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>観察データを用いたATEの推定値：2</li>
<li>統制群と処置群が逆でもATEの推定値：2</li>
</ul>
</div></div>
</section>
<section id="平均独立と交換可能性が成立しない例" class="slide level2">
<h2>平均独立と交換可能性が成立しない例</h2>
<p>真のATEが2の例</p>
<div class="columns">
<div class="column" style="width:35%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(D_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y_i(0)\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y_i(1)\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:65%;">
<ul>
<li>平均独立：<span class="alert">不成立</span>
<ul>
<li><span class="math inline">\(\mathbb{E}[Y(0)|D = 1] = 5.8 \neq \mathbb{E}[Y(0)|D = 0] = 2.8\)</span></li>
<li><span class="math inline">\(\mathbb{E}[Y(1)|D = 1] = 7.8 \neq \mathbb{E}[Y(1)|D = 0] = 4.8\)</span></li>
</ul></li>
<li>交換可能性：<span class="alert">不成立</span>（潜在的結果の分布が異なる）</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(Y(0)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y(1)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">統制群</td>
<td style="text-align: center;"><strong>[2, 4]</strong></td>
<td style="text-align: center;">[4, 6]</td>
</tr>
<tr class="even">
<td style="text-align: left;">処置群</td>
<td style="text-align: center;">[5, 7]</td>
<td style="text-align: center;"><strong>[7, 9]</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>観察データを用いたATEの推定値：5</li>
<li>統制群と処置群が逆でもATEの推定値：-1</li>
</ul>
</div></div>
</section>
<section id="平均独立のみ成立する例" class="slide level2">
<h2>平均独立のみ成立する例</h2>
<p>真のATEが0の例</p>
<div class="columns">
<div class="column" style="width:35%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(D_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y_i(0)\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y_i(1)\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Y\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:65%;">
<ul>
<li>平均独立：成立
<ul>
<li><span class="math inline">\(\mathbb{E}[Y(0)|D = 1] = \mathbb{E}[Y(0)|D = 0] = 4\)</span></li>
<li><span class="math inline">\(\mathbb{E}[Y(1)|D = 1] = \mathbb{E}[Y(1)|D = 0] = 12\)</span></li>
</ul></li>
<li>交換可能性：<span class="alert">不成立</span>（潜在的結果の分布が異なる）</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(Y(0)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y(1)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">統制群</td>
<td style="text-align: center;"><strong>[2, 6]</strong></td>
<td style="text-align: center;">[10, 14]</td>
</tr>
<tr class="even">
<td style="text-align: left;">処置群</td>
<td style="text-align: center;">[10, 14]</td>
<td style="text-align: center;"><strong>[2, 6]</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>観察データを用いたATEの推定値：0</li>
<li>統制群と処置群が逆ならATEの推定値：0</li>
</ul>
</div></div>
</section>
<section id="平均独立交換可能性の確認" class="slide level2">
<h2>平均独立・交換可能性の確認</h2>
<p>結論：<span class="alert">平均独立・交換可能性の成立有無は確認できない</span><span class="small">（因果推論の根本問題）</span></p>
<ul>
<li>「内生性が存在しない」ことは確認できない<sup>1</sup></li>
<li>それでも信頼できる処置効果の推定のためには内生性の確認が必要</li>
<li>解決策
<ul>
<li><del>既存のデータに内生性がないことを確認する</del>（不可能）</li>
<li>理論的に内生性をなくす<span class="small">（条件付け）</span></li>
<li>理論的に内生性が（ほぼ）存在しないはずのデータを見つける<span class="small">（自然実験・疑似実験）</span></li>
<li><span class="alert"><strong>内生性が存在しないデータを作り上げる</strong></span><span class="small">（実験）</span></li>
</ul></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn2"><p>後述するバランスチェックを行えば、平均独立・交換可能性が満たされて<strong><ruby>いない<rt>・・・</rt></ruby></strong>ことは確認できるが、平均独立・交換可能性が満たされていることは示せない。</p></li></ol></aside></section></section>
<section>
<section id="無作為割り当て" class="title-slide slide level1 center">
<h1><strong>2</strong> 無作為割り当て</h1>

</section>
<section id="無作為割り当てrandom-assignment" class="slide level2">
<h2>無作為割り当て<span class="small">（Random assignment）</span></h2>
<ul>
<li>被験者（人間や動物など）を複数のグループ（統制群や処置群など）に、コイン投げや乱数発生器などの偶然性によって割り当てる手法</li>
<li>各個体がどのグループに割り当てられるかは等しい確率
<ul>
<li>グループが2つ（<span class="math inline">\(D\)</span> = {0, 1}）なら…</li>
<li>Pr(<span class="math inline">\(D_i\)</span> = 1) = Pr(<span class="math inline">\(D_{j \neq i}\)</span> = 1) &amp; Pr(<span class="math inline">\(D_i\)</span> = 0) = Pr(<span class="math inline">\(D_{j \neq i}\)</span> = 0)</li>
</ul></li>
<li>グループ間の事前の差異を最小限に抑えることが可能</li>
</ul>

<img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center r-stretch" width="3000"></section>
<section id="無作為抽出random-samplingとの違い" class="slide level2">
<h2>無作為抽出<span class="small">（Random sampling）</span>との違い</h2>
<ul>
<li>サンプリング法の一つであり、主に母集団から標本（サンプル）を抽出する際に用いられる（とされている）
<ul>
<li><strong>単純無作為抽出</strong><sup>1</sup>：母集団内の各個体が標本として選ばれる確率は等しい</li>
</ul></li>
<li>無作為抽出された標本は母集団を代表する
<ul>
<li>無作為抽出された標本の分布は母集団の分布と同じ<sup>2</sup>（<span class="alert">交換可能性が成立</span>）</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" width="2700"></p>
</figure>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn3"><p>無作為抽出にも様々なバリエーションがあり、単純無作為抽出、系統無作為抽出、層化無作為抽出などがある。詳細は社会調査法、サンプリングの教科書を参照すること</p></li><li id="fn4"><p>また、標本の大きさが十分であれば、大数の法則（law of large number）により平均独立性も成り立つ。</p></li></ol></aside></section>
<section id="無作為割り当てと交換可能性" class="slide level2">
<h2>無作為割り当てと交換可能性</h2>
<p>交換可能性が成立するので、平均独立は当然ながら成立</p>

<img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1200"></section>
<section id="無作為抽出-無作為割り当て" class="slide level2">
<h2>無作為抽出 + 無作為割り当て</h2>
<p>無作為抽出 + 無作為割り当て：<span class="alert">統制群と処置群と標本と母集団は交換可能</span></p>
<ul>
<li>「処置群の結果変数 = 母集団に処置を施した場合の結果変数」として解釈可能</li>
<li>理想の話ではあり、標本が母集団を代表しない（交換不可能）ケースも多い</li>
</ul>

<img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center r-stretch" width="2400"></section>
<section id="無作為割り当ての方法" class="slide level2">
<h2>無作為割り当ての方法</h2>
<ul>
<li><span class="alert"><strong>ベルヌーイ実験</strong></span><span class="small">（Bernoulli randomized experiment; コイン投げ）</span>
<ul>
<li>各個体は確率<span class="math inline">\(p\)</span>で独立的に処置を受ける</li>
<li>「望ましくない」ランダム化の可能性あり（例：すべての固体が処置群になる）</li>
</ul></li>
<li><span class="alert"><strong>完全ランダム化実験</strong></span><span class="small">（completely randomized experiment）</span>
<ul>
<li>予め処置群の大きさ<span class="math inline">\(n_1\)</span>を決め（<span class="math inline">\(n_1 &lt; n\)</span>）、全個体の中から<span class="math inline">\(n_1\)</span>個をランダムに選ぶ</li>
<li>「望ましくない」ランダム化の可能性あり（例：処置群の全員が女性になる）</li>
</ul></li>
<li><span class="alert"><strong>ブロック別（層別）ランダム化実験</strong></span><span class="small">（block/stratified randomized experiment）</span>
<ul>
<li>サンプルを2つ以上のブロックに分け、ブロック内で完全無作為割り当てを行う</li>
<li>ブロックが2つのみの場合、「<span class="alert"><strong>ペアごとのランダム化実験</strong></span>」<span class="small">（paired randomized experiment）</span>と呼ばれる</li>
</ul></li>
</ul>
</section>
<section id="ブロッキング" class="slide level2">
<h2>ブロッキング</h2>
<ul>
<li>完全ランダム化の場合、偏ったグループが出来上がる可能性がある<sup>1</sup></li>
<li><span class="alert"><strong>ブロッキング</strong></span><span class="small">（blocking）</span>：ブロック内で完全ランダム化割り当てを実施
<ul>
<li>例）男性と女性の中で完全ランダム化割り当てを実施</li>
</ul></li>
<li><span class="alert">推定の精度が上がる</span>ため、ブロッキングできる場合、ブロッキングをした方が良い</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-11-1.png" width="1500"></p>
<figcaption>完全ランダム化が失敗した例</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-11-2.png" width="1500"></p>
<figcaption>ブロック別ランダム化の例</figcaption>
</figure>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn5"><p>サンプルサイズ（<span class="math inline">\(n\)</span>）が十分大きい場合、この可能性は低い。</p></li></ol></aside></section></section>
<section>
<section id="ランダム化比較試験" class="title-slide slide level1 center">
<h1><strong>3</strong> ランダム化比較試験</h1>

</section>
<section id="ランダム化比較試験-1" class="slide level2">
<h2>ランダム化比較試験</h2>
<p><span class="alert"><strong>ランダム化比較試験</strong></span>（randomized controlled trials; <strong>RCT</strong>）</p>
<ul>
<li>標本<span class="small">（サンプル）</span>を無作為割り当てで2つ以上のグループに分割し、各グループに異なる処置<sup>1</sup>を施し、結果変数を比較する手法</li>
<li><span class="alert"><strong>実験</strong></span><span class="small">（experiment）</span>とも呼ばれる因果推論の王道<span class="small">（best practice）</span></li>
</ul>
<p>グループを3つに分け👦🏻👧🏻👧🏽👦🏽👦🏿👧🏿、薬を与え💊（0〜2）、体温計🌡️</p>

<aside><div>
<p>厳密にはグループ1には偽薬2錠、グループ2には新薬と偽薬を1錠ずつ、グループ3には新薬を2錠与えた方が望ましい。</p>
</div><ol class="aside-footnotes"><li id="fn6"><p>ここには処置を施さないことも含まれる。</p></li></ol></aside></section>
<section id="実験の種類" class="slide level2">
<h2>実験の種類</h2>
<p>Hyde<span class="small">（2015）</span>による分類</p>
<ul>
<li>フィールド実験</li>
<li>実験室実験</li>
<li>サーベイ実験</li>
</ul>
<p>それぞれの実験は長所と短所を持つ</p>
<ul>
<li>以下は目安であり、設計次第でいくらでも上下する</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">種類</th>
<th style="text-align: center;">内的妥当性</th>
<th style="text-align: center;">外的妥当性</th>
<th style="text-align: center;">実施コスト</th>
<th style="text-align: center;">コントロール性</th>
<th style="text-align: left;">対象</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">実験室実験</td>
<td style="text-align: center;">高</td>
<td style="text-align: center;">低〜中</td>
<td style="text-align: center;">低〜高</td>
<td style="text-align: center;">高</td>
<td style="text-align: left;">大学生など</td>
</tr>
<tr class="even">
<td style="text-align: left;">フィールド実験</td>
<td style="text-align: center;">低〜中</td>
<td style="text-align: center;">高</td>
<td style="text-align: center;">高</td>
<td style="text-align: center;">中</td>
<td style="text-align: left;">一般市民など</td>
</tr>
<tr class="odd">
<td style="text-align: left;">サーベイ実験</td>
<td style="text-align: center;">中〜高</td>
<td style="text-align: center;">中</td>
<td style="text-align: center;">中〜高</td>
<td style="text-align: center;">中</td>
<td style="text-align: left;">全国・国際的</td>
</tr>
</tbody>
</table>

<aside><div>
<ul>
<li>Hyde, Susan D.. 2015. “<a href="https://doi.org/10.1146/annurev-polisci-020614-094854">Experiments in International Relations: Lab, Survey, and Field</a>.” <em>Annual Review of Political Science,</em> 18: 403-424.</li>
</ul>
</div></aside></section>
<section id="フィールド実験field-experiment" class="slide level2">
<h2>フィールド実験<span class="small">（field experiment）</span></h2>
<p>実生活<span class="small">（学校、地域、職場、選挙など）</span>の場面で行われる実験。</p>
<ul>
<li>メリット
<ul>
<li>外的妥当性<span class="small">（現実の行動に近い）</span></li>
<li>自然な環境で被験者が行動するため、実験効果が出にくい</li>
<li>政策介入の効果などを現場で検証できる</li>
</ul></li>
<li>デメリット
<ul>
<li>内的妥当性<span class="small">（外的要因が混入しやすい）</span></li>
<li>高い実施コスト<span class="small">（+ 許可や倫理的配慮も必要）</span></li>
<li>研究者による統制が限定的</li>
</ul></li>
</ul>
</section>
<section id="フィールド実験の例" class="slide level2">
<h2>フィールド実験の例</h2>
<ul>
<li>問い：啓発メッセージは投票参加を促すか<span class="small">（Gerber, Green, and Larimer 2008）</span></li>
<li>統制群：処置なし</li>
<li>処置群：<span class="alert">投票参加を促すメッセージが記載されたハガキ</span>を発送</li>
<li>メッセージの処置効果 = 処置群の投票率 - 統制群の投票率</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" width="3000"></p>
</figure>
</div>
</div>
</div>

<aside><div>
<ul>
<li>Gerber, Alan S., Donald P. Green, and Christopher W. Larimer. 2008. “<a href="https://doi.org/10.1017/S000305540808009X">Social Pressure and Voter Turnout: Evidence from a Large-Scale Field Experiment</a>.” <em>American Political Science Review</em> 102(1): 33–48.</li>
<li>Gerber, Alan S. and Donald P. Green. 2012. <a href="https://www.amazon.co.jp/dp/0393979954/"><em>Field Experiments</em></a>, Norton.</li>
</ul>
</div></aside></section>
<section id="実験室実験labotary-experiment" class="slide level2">
<h2>実験室実験<span class="small">（labotary experiment）</span></h2>
<p>研究者が完全にコントロールされた環境<span class="small">（例：大学の実験室）</span>で行う実験</p>
<ul>
<li>主に心理学・経済学などで用いられる</li>
<li>メリット
<ul>
<li>高い内部妥当性<span class="small">（因果関係の識別が容易）</span></li>
<li>外部のノイズを排除しやすい</li>
<li>実験環境の精密なコントロールが可能</li>
</ul></li>
<li>デメリット
<ul>
<li>外的妥当性</li>
<li>観測者効果、ホーソン効果<span class="small">（被験者が「実験されている」と強く意識）</span></li>
<li>限定されたサンプルになりがち<span class="small">（主に大学生）</span></li>
</ul></li>
</ul>
<blockquote>
<p><em>College sophomores may not be people</em>（Hovland 1959）</p>
</blockquote>

<aside><div>
<p>Hovland, Carl. I. 1959. “<a href="https://doi.org/10.1037/h0042210">Reconciling conflicting results derived from experimental and survey studies of attitude change</a>.” <em>American Psychologist,</em> 14(1): 8–17.</p>
</div></aside></section>
<section id="実験室実験の例" class="slide level2">
<h2>実験室実験の例</h2>
<ul>
<li>問い：討議は少数派への配慮が強めるか</li>
<li><strong>Step 1：</strong>全員を対象に不公平に対する嫌悪感（inequity aversion）を測定</li>
<li><strong>Step 2：</strong>公平な配分案 vs.&nbsp;多数派優遇の不公平配分案の投票
<ul>
<li>処置群のみ<span class="alert">グループ内のコミュニケーション（議論）</span>を許可</li>
</ul></li>
<li><strong>Step 3：</strong>全員を対象とした5つの配分案の投票</li>
<li>議論の処置効果 = 公平な配分案への処置群の支持 - 公平な配分案への統制群の支持</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="2250"></p>
</figure>
</div>
</div>
</div>

<aside><div>
<ul>
<li>Woon, Jonathan, Minsu Jang, Kira Pronin and Jacob Schiller. 2023. “<a href="https://doi.org/10.1017/XPS.2023.29">Discussion and Fairness in a Laboratory Voting Experiment</a>,” <em>Journal of Experimental Political Science,</em> 11(2): 224-236.</li>
</ul>
</div></aside></section>
<section id="サーベイ実験survey-experiment" class="slide level2">
<h2>サーベイ実験<span class="small">（survey experiment）</span></h2>
<p>アンケート内に無作為割当の処置<span class="small">（例：文言の違い、シナリオの提示）</span>を埋め込み、参加者の反応を比較する実験</p>
<ul>
<li>インターネットを用いたアンケートに処置を埋め込むのが一般的</li>
<li>メリット
<ul>
<li>実施コストが低く、大規模サンプルを得やすい</li>
<li>インターネット調査での実施が可能（時系列や国際比較も容易）</li>
<li>さまざまな認知的・態度的反応が測定可能</li>
</ul></li>
<li>デメリット
<ul>
<li>行動ではなく意見や認識の測定が中心<span class="small">（行動的な結果の妥当性に限界）</span></li>
<li>省力回答者（satisficer）の存在</li>
<li>処置の「強さ」が限られ、効果量が小さくなることが多い</li>
</ul></li>
</ul>

<aside><div>
<ul>
<li>SONG Jaehyun・秦正樹. 2020. 「<a href="https://doi.org/10.11218/ojjams.35.92">オンライン・サーベイ実験の方法：理論編</a>」『理論と方法』35(1): 92-108.</li>
<li>秦正樹・SONG Jaehyun. 2020. 「<a href="https://doi.org/10.11218/ojjams.35.109">オンライン・サーベイ実験の方法：実践編</a>」『理論と方法』35(1): 109-127.</li>
</ul>
</div></aside></section>
<section id="サーベイ実験の例" class="slide level2">
<h2>サーベイ実験の例</h2>
<ul>
<li>問い：日米韓軍事同盟は日韓協力への支持を高めるか<span class="small">（Asaba et al.&nbsp;2020）</span></li>
<li>統制群：米豪合同軍事演習の動画を視聴</li>
<li>処置群：<span class="alert">日米韓同軍事演習の動画</span>を視聴</li>
<li>動画の処置効果 = 処置群の日韓協力への支持度 - 統制群の日韓協力への支持度</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="3000"></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>Asaba, Yuki, Kyu S Hahn, Seulgi Jang, Tetsuro Kobayashi, and Atsushi Tago. 2020. “<a href="https://doi.org/10.1093/irap/lcy024">38 seconds above the 38th parallel: how short video clips produced by the US military can promote alignment despite antagonism between Japan and Korea</a>,” <em>International Relations of the Asia-Pacific</em>, 20(2): 253-273.</p>
</div></aside></section></section>
<section>
<section id="処置効果の推定" class="title-slide slide level1 center">
<h1><strong>4</strong> 処置効果の推定</h1>

</section>
<section id="処置効果の推定-1" class="slide level2">
<h2>処置効果の推定</h2>
<p>結果変数の平均値をグループ間で比較</p>
<ul>
<li>ATE = <span class="math inline">\(\mathbb{E}[Y|D = 1] - \mathbb{E}[Y|D = 0]\)</span>
<ul>
<li>ATE = 処置群の結果変数の平均値 - 統制群の結果変数の平均値</li>
</ul></li>
</ul>
<p>使用可能な手法</p>
<ul>
<li>平均値/比率の差の検定<span class="small">（<span class="math inline">\(t\)</span>検定、<span class="math inline">\(z\)</span>検定）</span>
<ul>
<li>グループが3つ以上の場合、ペアごと<span class="small">（pairwise）</span>の検定を実施</li>
</ul></li>
<li>分散分析<span class="small">（ANOVA、MANCOVAなど）</span></li>
<li><span class="alert"><strong>線形回帰分析</strong></span></li>
</ul>
</section>
<section id="多重比較の問題multiple-comparisons-problem" class="slide level2">
<h2>多重比較の問題<span class="small">（multiple comparisons problem）</span></h2>
<ul>
<li><span class="alert">複数回の比較から処置効果を推定する際に発生</span>する問題
<ul>
<li>統制群と処置群1、処置群2がある場合、「統制群 vs.&nbsp;処置群1」、「統制群 vs.&nbsp;処置群2」計2回の比較が行われる</li>
</ul></li>
<li><span class="math inline">\(p\)</span> = 0.05を基準とした統計的有意性検定の限界
<ul>
<li>処置効果が0でも、処置効果があると判定される可能性は約5%</li>
<li><span class="alert"><strong>比較が複数回行われたら、処置効果があると判定される可能性が自然に上がる</strong></span>
<ul>
<li>2回の比較のうち、1つでも<span class="math inline">\(p\)</span> &lt; 0.05になったら「処置効果がある」と判定するから</li>
</ul></li>
</ul></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">施行</th>
<th style="text-align: right;">統制群 vs.&nbsp;処置群1</th>
<th style="text-align: right;">統制群 vs.&nbsp;処置群2</th>
<th style="text-align: center;">処置効果</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.878</td>
<td style="text-align: center;">留保</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: right;">0.447</td>
<td style="text-align: right;"><span class="alert">0.048</span></td>
<td style="text-align: center;"><span class="alert">あり</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: right;">0.693</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: center;">留保</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: right;"><span class="alert">0.011</span></td>
<td style="text-align: right;">0.899</td>
<td style="text-align: center;"><span class="alert">あり</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: center;">留保</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.878</td>
<td style="text-align: center;">留保</td>
</tr>
</tbody>
</table>
</section>
<section id="多重比較の問題の補正" class="slide level2">
<h2>多重比較の問題の補正</h2>
<p><span class="alert"><strong>ボンフェローニ補正</strong></span><span class="small">（Bonferroni correction）</span><sup>1</sup>の例</p>
<ul>
<li>真の処置効果が0でも、計2回の比較が行われる場合、それぞれの比較において<span class="math inline">\(p\)</span> &lt; 0.05になる割合は5%
<ul>
<li>1つでも<span class="math inline">\(p\)</span> &lt; 0.05になったら「処置効果がある」と判定される</li>
<li>計2回の比較が行われるため、「処置効果がある」と判定される割合は10%（<strong>2倍</strong>）</li>
<li><span class="math inline">\(\Rightarrow\)</span> <span class="alert">「処置効果がある」と判定される可能性は既存の<span class="math inline">\(m\)</span>倍</span>（<span class="math inline">\(m\)</span>は比較回数）</li>
<li><span class="math inline">\(\Rightarrow\)</span> <strong>解決策：</strong><span class="alert">統計的有意性の閾値（<span class="math inline">\(\alpha\)</span>）を<span class="math inline">\(m\)</span>分の1に変更</span>する</li>
</ul></li>
<li>例）<span class="math inline">\(\alpha = 0.05\)</span>、比較回数が2回の場合
<ul>
<li><span class="math inline">\(p\)</span>値が0.025（= 0.05 / 2）を下回る場合、「5%水準で統計的に有意」と解釈する</li>
</ul></li>
<li>例）<span class="math inline">\(\alpha = 0.05\)</span>、比較回数が5回の場合
<ul>
<li><span class="math inline">\(p\)</span>値が0.01（= 0.05 / 5）を下回る場合、「5%水準で統計的に有意」と解釈する</li>
</ul></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn7"><p>他にもホルム法（Holm method）、シダック補正（Šidák correction）、シェッフェ法（Scheffé’s method）、テューキー法（Tukey HSD）など様々な補正法がある。</p></li></ol></aside></section>
<section id="不均一な処置効果の推定" class="slide level2">
<h2>不均一な処置効果の推定</h2>
</section></section>
<section>
<section id="実装時の注意点" class="title-slide slide level1 center">
<h1><strong>5</strong> 実装時の注意点</h1>

</section>
<section id="実験デザイン時の注意点" class="slide level2">
<h2>実験デザイン時の注意点</h2>
</section>
<section id="実験と研究倫理" class="slide level2">
<h2>実験と研究倫理</h2>
</section>
<section id="sutva" class="slide level2">
<h2>SUTVA</h2>
<p><span class="alert"><strong>Stable Unit Treatment Value Assumption</strong></span>（Rubin 1980）</p>
<blockquote>
<p>　個々のユニットにおける潜在的結果は、他のユニットが受ける処置によって変化しない。また、個々のユニットに対する処置水準は一定であり、異なる潜在的結果を導くような処置水準の携帯敵・内容的な変動はない。（インベンス・ルービン 2023: 11）</p>
</blockquote>
<ul>
<li>相互干渉がないこと
<ul>
<li>にゃん！</li>
</ul></li>
<li>処置の隠れた変動がないこと
<ul>
<li>にゃん！</li>
</ul></li>
</ul>

<aside><div>
<ul>
<li>Rubin, Donald B. 1980. “Discussion of”Randomization Analysis of Experimental Data in the Fisher Randomization Test” by Basu,” <em>The Journal of the American Statistical Association</em>, 75 (371): 591-593.</li>
<li>G.W. インベンス・D.B. ルービン 著. 星野崇宏・繁桝算男 訳. 2023. 『インベンス・ルービン 統計的因果推論 (上)』朝倉書店</li>
</ul>
</div></aside></section>
<section id="二重盲検法" class="slide level2">
<h2>二重盲検法</h2>
</section>
<section id="バランスチェック" class="slide level2">
<h2>バランスチェック</h2>
<p>グループ間に平均独立が不成立しているかを確認する手法</p>
<ul>
<li>統計的有意性検定<span class="small">（<span class="math inline">\(t\)</span>検定、ANOVAなど）</span>は<span class="alert"><strong>非推奨</strong></span><span class="small">（Imai et al.&nbsp;2008）</span></li>
<li><span class="alert"><strong>平均値の差分</strong></span><span class="small">（mean difference）</span><sup>1</sup>の使用を推奨
<ul>
<li><span class="alert"><strong>平均値の差分が大きい = グループ間に平均独立が不成立</strong></span></li>
<li>バランスの閾値は研究者が任意で決める<span class="small">（主に<span class="alert"><strong>0.1</strong></span>）</span>
<ul>
<li>傾向スコアのバランスチェックには0.25を採用する場合も<span class="small">（Ho et al.&nbsp;2017）</span></li>
</ul></li>
<li>グループが3つ以上ならペアごとに<span class="small">（標準化した）</span>平均値の差分を計算</li>
</ul></li>
<li>実験データであってもバランスしていない<span class="small">（imbalanced）</span>可能性がある</li>
<li>バランスしていないデータでも<span class="alert">共変量調整でバイアスの補正</span>が可能<span class="small">（Lin 2013）</span></li>
</ul>

<aside><div>
<ul>
<li>Imai, Kosuke, Gary King, Elizabeth A. Stuart. 2008. “<a href="https://doi.org/10.1111/j.1467-985X.2007.00527.x">Misunderstandings between experimentalists and observationalists about causal inference</a>.” <em>Journal of the Royal Statistical Society: Series A,</em> 171(2): 481-502.</li>
<li>Ho, Daniel E., Kosuke Imai, Gary King and Elizabeth A. Stuart. 2017. “<a href="https://doi.org/10.1093/pan/mpl013">Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inferen</a>.” <em>Political Analysis,</em> 15(3): 199-236.</li>
<li>Lin, Winston. 2013. “<a href="https://doi.org/10.1214/12-AOAS583">Agnostic Notes on Regression Adjustments to Experimental Data: Reexamining Freedman’s Critique</a>.” <em>The Annals of Applied Statistics</em> 7(1): 295-318.</li>
</ul>
</div><ol class="aside-footnotes"><li id="fn8"><p>共変量が連続変数の場合、標準化した平均値の差分<span class="small">（standardized mean difference）</span>を使用する。平均値の差分を<span class="math inline">\(s^*\)</span>で割ることで標準化した平均値の差分が計算できる。ATEを推定する場合、<span class="math inline">\(s^* = \sqrt{\frac{1}{2} (s_1^2 + s_0^2)}\)</span>であり、<span class="math inline">\(s_1\)</span>と<span class="math inline">\(s_0\)</span>はそれぞれ処置群と統制群の標準偏差である。ちなみに、推定対象がATTなら<span class="math inline">\(s^* = s_1\)</span>、ATCなら<span class="math inline">\(s^* = s_0\)</span>である。</p></li></ol></aside></section>
<section id="バランスチェックの例" class="slide level2">
<h2>バランスチェックの例</h2>
<p>{cobalt}パッケージ<sup>1</sup>を利用したバランスチェックの例</p>
<ul>
<li>左の図の場合、ほとんどの共変量においてバランスが取れていない<span class="small">（閾値=0.1の場合）</span></li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-15-1.png" width="1500"></p>
<figcaption>例1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rct_slide_files/figure-revealjs/unnamed-chunk-15-2.png" width="1500"></p>
<figcaption>例2</figcaption>
</figure>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn9"><p>{<a href="https://github.com/JaehyunSong/BalanceR">BalanceR</a>}パッケージがより簡単に使えるが、{cobalt}の方がより汎用性が高い。それでも{<a href="https://github.com/JaehyunSong/BalanceR">BalanceR</a>}を使ってくれるなら感謝しかない。</p></li></ol></aside></section>
<section id="参考書" class="slide level2">
<h2>参考書</h2>


</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>ランダム化比較試験</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "コピーしました");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "コピーしました");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>