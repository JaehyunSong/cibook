<!DOCTYPE html>
<html lang="ja"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="宋財泫（関西大学）">
  <title>困菓唯倫 with R – 社会科学における因果推論</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-b6d722145684ebde2f4126fbe9a56250.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">社会科学における因果推論</h1>
  <p class="subtitle">5/ 回帰分析</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
宋財泫（関西大学） 
</div>
</div>
</div>

</section>
<section>
<section id="回帰分析" class="title-slide slide level1 center">
<h1><strong>1</strong> 回帰分析</h1>

</section>
<section id="単回帰分析" class="slide level2">
<h2>単回帰分析</h2>
<p><span class="alert"><strong>単回帰分析</strong></span><span class="small">（simple regression）</span>：説明変数が1つのみの線形回帰分析</p>
<ul>
<li><span class="math inline">\(Y\)</span>を<span class="math inline">\(D\)</span>に回帰する<span class="small">（regress <span class="math inline">\(Y\)</span> on <span class="math inline">\(D\)</span>）</span></li>
</ul>
<p><span class="math display">\[
Y_i = \mathbb{E}[Y_i|D_i] + \varepsilon_i = \alpha + \tau D_i + \varepsilon_i
\]</span></p>
<h3 id="最小二乗法ordinary-least-squares-ols">最小二乗法<span class="small">（ordinary least squares; OLS）</span></h3>
<ul>
<li><span class="alert"><strong>残差の二乗和を最小とする<span class="math inline">\(\hat{\alpha}\)</span>と<span class="math inline">\(\hat{\tau}\)</span>を推定</strong></span>
<ul>
<li>残差<span class="small">（residuals）</span>：<span class="math inline">\(u_i = Y_i - \hat{\alpha} - \hat{\tau} D_i\)</span></li>
<li><span class="math inline">\(\bar{u_i}\)</span>の平方根：RMSE<span class="small">（Root mean square error）</span></li>
</ul></li>
</ul>
<p><span class="math display">\[
(\hat{\alpha}, \hat{\tau}) = \mathop{\arg \min}_{\alpha, \tau} \sum_{i}^{n}(Y_i - \alpha - \tau D_i)^2
\]</span></p>
</section>
<section id="最小二乗法" class="slide level2">
<h2>最小二乗法</h2>
<ul>
<li>残差の二乗和は141.13（左）、<span class="alert">58.82</span>（中）、66.55（右）
<ul>
<li>RMSEはそれぞれ3.76、<span class="alert">2.43</span>、2.58</li>
</ul></li>
</ul>

<img data-src="reg_slide_files/figure-html/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center r-stretch" width="2100"></section>
<section id="単回帰分析と因果推論" class="slide level2">
<h2>単回帰分析と因果推論</h2>
<p><span class="alert"><strong>処置変数が外生変数、かつ二値変数なら<span class="math inline">\(D_i\)</span>の係数の推定値はATEの推定値</strong></span></p>
<ul>
<li>処置変数<span class="math inline">\(D\)</span>が二値変数の場合、<span class="math inline">\(\hat{\tau}\)</span>は二群間の平均値の差分
<ul>
<li><span class="math inline">\(\hat{\tau}\)</span> = ATT + セレクションバイアス</li>
</ul></li>
</ul>
<p><span class="math display">\[
\small
\begin{align}
\hat{\tau} &amp; = \mathbb{E}[Y_i(1)|D_i = 1] - \mathbb{E}[Y_i(0)|D_i = 0] \\
&amp; = \underbrace{\mathbb{E}[Y_i(1)|D_i = 1] - \mathbb{E}[Y_i(0)|D_i = 1]}_{\textsf{ATT}} + \underbrace{\mathbb{E}[Y_i(0)|D_i = 1] - \mathbb{E}[Y_i(0)|D_i = 0]}_{\textsf{selection bias}}
\end{align}
\]</span></p>
<ul>
<li>処置変数が外生変数（=交換可能性/平均独立が成立）なら…<sup>1</sup><sup>2</sup></li>
</ul>
<p><span class="math display">\[
\hat{\tau} = \mathbb{E}[Y_i(1)] - \mathbb{E}[Y_i(0)] = \textsf{ATE}
\]</span></p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>交換可能性、または平均独立が成立する場合、<span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 1] = \mathbb{E}[Y_i(1)|D_i = 0]\)</span>、かつ<span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 1] = \mathbb{E}[Y_i(0)|D_i = 0]\)</span>だから</p></li><li id="fn2"><p>セレクションバイアスが0なら（<span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 1] = \mathbb{E}[Y_i(0)|D_i = 0]\)</span>）、<span class="math inline">\(\hat{\tau}\)</span>はATEでなく、ATT</p></li></ol></aside></section>
<section id="誤差に関する仮定" class="slide level2">
<h2>誤差に関する仮定</h2>
<ul>
<li>回帰分析における誤差の仮定
<ul>
<li>誤差の期待値は0（<span class="math inline">\(\mathbb{E}[\varepsilon_i]\)</span> = 0）</li>
<li><span class="alert"><strong>誤差と説明変数は独立</strong></span>（<span class="math inline">\(\textsf{Cov}(D, \varepsilon)\)</span> = <span class="math inline">\(\mathbb{E}[D \times \varepsilon]\)</span> = 0）</li>
</ul></li>
</ul>

<img data-src="reg_slide_files/figure-html/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1800"></section>
<section id="処置変数が内生変数の場合" class="slide level2">
<h2>処置変数が内生変数の場合</h2>
<ul>
<li>誤差と説明変数は独立しない場合、<span class="math inline">\(\hat{\tau}\)</span>はバイアス付きのATT
<ul>
<li><span class="math inline">\(\textsf{Cov}(D, \varepsilon) \neq\)</span> 0</li>
<li><span class="math inline">\(\mathbb{E}[D \times \varepsilon] \neq\)</span> 0</li>
</ul></li>
</ul>

<img data-src="reg_slide_files/figure-html/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1800"></section>
<section id="交絡要因が既知の場合" class="slide level2">
<h2>交絡要因が既知の場合</h2>
<ul>
<li>観察済みの変数<span class="math inline">\(X\)</span>が唯一の交絡要因ある場合
<ul>
<li>単回帰分析では<span class="math inline">\(X\)</span>は<span class="math inline">\(\varepsilon\)</span>の一部だったが、<span class="math inline">\(X\)</span>が観察済みなら<span class="math inline">\(\varepsilon \rightarrow X\)</span>のパスを消せる</li>
<li>そのためには、内生性の原因である<span class="math inline">\(X\)</span>を考慮したモデリングが必要</li>
</ul></li>
</ul>

<img data-src="reg_slide_files/figure-html/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1800"></section>
<section id="重回帰分析" class="slide level2">
<h2>重回帰分析</h2>
<p>統制変数<span class="math inline">\(X\)</span>を追加した回帰モデル</p>
<p><span class="math display">\[
\begin{align}
Y_i &amp; = \mathbb{E}[Y_i|D_i, X_i] + \varepsilon_i \\
&amp; = \alpha + \tau D_i + \beta X_i + \varepsilon_i
\end{align}
\]</span></p>
<ul>
<li><span class="alert"><strong>残差の二乗和を最小とする<span class="math inline">\(\hat{\alpha}\)</span>と<span class="math inline">\(\hat{\tau}\)</span>、<span class="math inline">\(\hat{\beta}\)</span>を推定</strong></span>
<ul>
<li>残差<span class="small">（residuals）</span>：<span class="math inline">\(Y_i - \alpha - \tau D_i - \beta X_i\)</span></li>
</ul></li>
</ul>
<p><span class="math display">\[
(\hat{\alpha}, \hat{\tau}, \hat{\beta}) = \mathop{\arg \min}_{\alpha, \tau, \beta} \sum_{i}^{n}(Y_i - \alpha - \tau D_i - \beta X_i)^2
\]</span></p>
</section>
<section id="統制変数の役割" class="slide level2">
<h2>統制変数の役割</h2>
<p><span class="math inline">\(X_i = x\)</span>における傾き（<span class="math inline">\(\tau\)</span>）の推定</p>
<ul>
<li><span class="math inline">\(X_i = x\)</span>における傾きと<span class="math inline">\(X_i = x^{\prime}\)</span>における傾きは同値だと仮定（<span class="math inline">\(x \neq x^{\prime}\)</span>）</li>
<li>この仮定を緩和するためには交差項が必要</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-8-2.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="統制変数とブロッキング" class="slide level2">
<h2>統制変数とブロッキング</h2>
<p>重回帰分析における係数は通常、「<span class="alert"><strong>他の変数が一定</strong></span>であれば…」と解釈される。</p>
<ul>
<li><span class="math inline">\(\Rightarrow\)</span> 重回帰分析の推定値 = ブロック内処置効果の加重平均</li>
</ul>
<h4 id="手順"><strong>手順</strong></h4>
<ol type="1">
<li>ブロックごとに処置効果（A）を推定する</li>
<li>（A）の加重平均を計算する。各ブロックの重みは、
<ul>
<li><span class="math inline">\(Pr(X_i = x)\)</span>（ATEを推定する場合）</li>
<li><span class="math inline">\(Pr(X_i = x, D_i = 1)\)</span>（ATTを推定する場合）</li>
<li><span class="math inline">\(Pr(X_i = x, D_i = 0)\)</span>（ATCを推定する場合）</li>
</ul></li>
</ol>
<ul>
<li><span class="math inline">\(\Rightarrow\)</span> <span class="alert">統制変数をうまく使えば因果推論ができそう</span>
<ul>
<li>どうすれば回帰分析で信頼できる処置効果が推定できるか</li>
<li><span class="math inline">\(\Rightarrow\)</span> [<strong>ブロック内で処置群と統制群が交換可能（or 平均独立）</strong>]{.alertであれば…?}</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="仮定" class="title-slide slide level1 center">
<h1><strong>2</strong> 仮定</h1>

</section>
<section id="条件付き独立の仮定" class="slide level2">
<h2>条件付き独立の仮定</h2>
<p><span class="alert"><strong>条件付き独立の仮定</strong></span><span class="small">（conditional independence assumption; <strong>CIA</strong>）</span></p>
<ul>
<li>統制変数（X）で条件づけた場合、処置変数（D）と結果変数（Y）の潜在的結果は独立する</li>
<li>条件付き独立 = 条件付き交換可能性 = 条件付き無視可能性</li>
</ul>
<p><span class="math display">\[
\{Y(0), Y(1)\} \mathop{\perp\!\!\!\!\perp} D | X
\]</span></p>
<ul>
<li>全体では交換可能性が成立しないものの、統制変数Xで条件づけた下位グループ内では交換可能性が成立</li>
<li><span class="alert"><strong>観察データを用いた回帰分析で因果推論を行うための仮定</strong></span></li>
</ul>
</section>
<section id="条件付き平均独立性" class="slide level2">
<h2>条件付き平均独立性</h2>
<p>CIAが成立すると<span class="alert"><strong>条件付き平均独立性</strong></span>が成り立つ</p>
<ul>
<li>平均独立性が成り立つとATEが推定可能となる</li>
</ul>
<p><span class="math display">\[
\mathbb{E}[Y_i(1)|D_i = 1, X_i = x] = \mathbb{E}[Y_i(1)|D_i = 0, X_i = x] = \mathbb{E}[Y_i(1)|X_i = x]
\]</span></p>
<center>
かつ
</center>
<p><span class="math display">\[
\mathbb{E}[Y_i(0)|D_i = 1, X_i = x] = \mathbb{E}[Y_i(0)|D_i = 0, X_i = x] = \mathbb{E}[Y_i(0)|X_i = x]
\]</span></p>
</section>
<section id="条件付き平均独立の例" class="slide level2">
<h2>条件付き平均独立の例</h2>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="vawendslok" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vawendslok table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vawendslok thead, #vawendslok tbody, #vawendslok tfoot, #vawendslok tr, #vawendslok td, #vawendslok th {
  border-style: none;
}

#vawendslok p {
  margin: 0;
  padding: 0;
}

#vawendslok .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 18px;
  font-weight: normal;
  font-style: normal;
  background-color: rgba(255, 255, 255, 0);
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vawendslok .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vawendslok .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-bottom-width: 0;
}

#vawendslok .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: rgba(255, 255, 255, 0);
  border-top-width: 0;
}

#vawendslok .gt_heading {
  background-color: rgba(255, 255, 255, 0);
  text-align: center;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vawendslok .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vawendslok .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vawendslok .gt_col_heading {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vawendslok .gt_column_spanner_outer {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vawendslok .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vawendslok .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vawendslok .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vawendslok .gt_spanner_row {
  border-bottom-style: hidden;
}

#vawendslok .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vawendslok .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vawendslok .gt_from_md > :first-child {
  margin-top: 0;
}

#vawendslok .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vawendslok .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vawendslok .gt_stub {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vawendslok .gt_stub_row_group {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vawendslok .gt_row_group_first td {
  border-top-width: 2px;
}

#vawendslok .gt_row_group_first th {
  border-top-width: 2px;
}

#vawendslok .gt_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vawendslok .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vawendslok .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vawendslok .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vawendslok .gt_grand_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vawendslok .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vawendslok .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vawendslok .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vawendslok .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vawendslok .gt_footnotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vawendslok .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vawendslok .gt_sourcenotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vawendslok .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vawendslok .gt_left {
  text-align: left;
}

#vawendslok .gt_center {
  text-align: center;
}

#vawendslok .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vawendslok .gt_font_normal {
  font-weight: normal;
}

#vawendslok .gt_font_bold {
  font-weight: bold;
}

#vawendslok .gt_font_italic {
  font-style: italic;
}

#vawendslok .gt_super {
  font-size: 65%;
}

#vawendslok .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vawendslok .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vawendslok .gt_indent_1 {
  text-indent: 5px;
}

#vawendslok .gt_indent_2 {
  text-indent: 10px;
}

#vawendslok .gt_indent_3 {
  text-indent: 15px;
}

#vawendslok .gt_indent_4 {
  text-indent: 20px;
}

#vawendslok .gt_indent_5 {
  text-indent: 25px;
}

#vawendslok .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vawendslok div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="D">D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X">X</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y">Y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(0)">Y(0)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(1)">Y(1)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">-1</td>
<td headers="Y(0)" class="gt_row gt_right">-1</td>
<td headers="Y(1)" class="gt_row gt_right">1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">5</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">6</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">-1</td>
<td headers="Y(0)" class="gt_row gt_right">-3</td>
<td headers="Y(1)" class="gt_row gt_right">-1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">7</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">-2</td>
<td headers="Y(1)" class="gt_row gt_right">0</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">8</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">-1</td>
<td headers="Y(1)" class="gt_row gt_right">1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">9</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">2</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">10</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">3</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">11</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">4</td>
<td headers="Y(1)" class="gt_row gt_right">6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">12</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">5</td>
<td headers="Y(1)" class="gt_row gt_right">7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">13</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">14</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">15</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">2</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">16</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">3</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">17</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">6</td>
<td headers="Y(0)" class="gt_row gt_right">6</td>
<td headers="Y(1)" class="gt_row gt_right">8</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">18</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">19</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">20</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">6</td>
<td headers="Y(0)" class="gt_row gt_right">4</td>
<td headers="Y(1)" class="gt_row gt_right">6</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div><div class="column" style="width:75%;">
<h3 id="真のate">真のATE</h3>
<p><span class="math display">\[
\underbrace{\mathbb{E}[Y_i(1)]}_{\textsf{3.5}} - \underbrace{\mathbb{E}[Y_i(0)]}_{\textsf{1.5}} = 2
\]</span></p>
<p><br></p>
<h3 id="ateの推定値">ATEの推定値</h3>
<p>Difference-in-means（DiM）推定量</p>
<p><span class="math display">\[
\underbrace{\mathbb{E}[Y_i|D_i = 1]}_{\textsf{2.9}} - \underbrace{\mathbb{E}[Y_i|D_i = 0]}_{\textsf{2.1}} = 0.8
\]</span></p>
</div></div>
</section>
<section id="平均独立性は成立するか" class="slide level2">
<h2>平均独立性は成立するか</h2>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="ejeoxdkgau" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ejeoxdkgau table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ejeoxdkgau thead, #ejeoxdkgau tbody, #ejeoxdkgau tfoot, #ejeoxdkgau tr, #ejeoxdkgau td, #ejeoxdkgau th {
  border-style: none;
}

#ejeoxdkgau p {
  margin: 0;
  padding: 0;
}

#ejeoxdkgau .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 18px;
  font-weight: normal;
  font-style: normal;
  background-color: rgba(255, 255, 255, 0);
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ejeoxdkgau .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ejeoxdkgau .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-bottom-width: 0;
}

#ejeoxdkgau .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: rgba(255, 255, 255, 0);
  border-top-width: 0;
}

#ejeoxdkgau .gt_heading {
  background-color: rgba(255, 255, 255, 0);
  text-align: center;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejeoxdkgau .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejeoxdkgau .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejeoxdkgau .gt_col_heading {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ejeoxdkgau .gt_column_spanner_outer {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ejeoxdkgau .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ejeoxdkgau .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ejeoxdkgau .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ejeoxdkgau .gt_spanner_row {
  border-bottom-style: hidden;
}

#ejeoxdkgau .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ejeoxdkgau .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ejeoxdkgau .gt_from_md > :first-child {
  margin-top: 0;
}

#ejeoxdkgau .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ejeoxdkgau .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ejeoxdkgau .gt_stub {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ejeoxdkgau .gt_stub_row_group {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ejeoxdkgau .gt_row_group_first td {
  border-top-width: 2px;
}

#ejeoxdkgau .gt_row_group_first th {
  border-top-width: 2px;
}

#ejeoxdkgau .gt_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejeoxdkgau .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ejeoxdkgau .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ejeoxdkgau .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejeoxdkgau .gt_grand_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejeoxdkgau .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ejeoxdkgau .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ejeoxdkgau .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ejeoxdkgau .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejeoxdkgau .gt_footnotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejeoxdkgau .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejeoxdkgau .gt_sourcenotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejeoxdkgau .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejeoxdkgau .gt_left {
  text-align: left;
}

#ejeoxdkgau .gt_center {
  text-align: center;
}

#ejeoxdkgau .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ejeoxdkgau .gt_font_normal {
  font-weight: normal;
}

#ejeoxdkgau .gt_font_bold {
  font-weight: bold;
}

#ejeoxdkgau .gt_font_italic {
  font-style: italic;
}

#ejeoxdkgau .gt_super {
  font-size: 65%;
}

#ejeoxdkgau .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ejeoxdkgau .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ejeoxdkgau .gt_indent_1 {
  text-indent: 5px;
}

#ejeoxdkgau .gt_indent_2 {
  text-indent: 10px;
}

#ejeoxdkgau .gt_indent_3 {
  text-indent: 15px;
}

#ejeoxdkgau .gt_indent_4 {
  text-indent: 20px;
}

#ejeoxdkgau .gt_indent_5 {
  text-indent: 25px;
}

#ejeoxdkgau .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ejeoxdkgau div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="D">D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X">X</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y">Y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(0)">Y(0)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(1)">Y(1)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">-1</td>
<td headers="Y(0)" class="gt_row gt_right">-1</td>
<td headers="Y(1)" class="gt_row gt_right">1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">5</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">6</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">-1</td>
<td headers="Y(0)" class="gt_row gt_right">-3</td>
<td headers="Y(1)" class="gt_row gt_right">-1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">7</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">-2</td>
<td headers="Y(1)" class="gt_row gt_right">0</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">8</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">-1</td>
<td headers="Y(1)" class="gt_row gt_right">1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">9</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">2</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">10</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">3</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">11</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">4</td>
<td headers="Y(1)" class="gt_row gt_right">6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">12</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">5</td>
<td headers="Y(1)" class="gt_row gt_right">7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">13</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">14</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">15</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">2</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">16</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">3</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">17</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">6</td>
<td headers="Y(0)" class="gt_row gt_right">6</td>
<td headers="Y(1)" class="gt_row gt_right">8</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">18</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">19</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">20</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">6</td>
<td headers="Y(0)" class="gt_row gt_right">4</td>
<td headers="Y(1)" class="gt_row gt_right">6</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div><div class="column" style="width:75%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;"><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i]\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_i = 0\)</span></td>
<td style="text-align: right;"><span class="alert"><strong>2.1</strong></span></td>
<td style="text-align: right;"><strong>4.1</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D_i = 1\)</span></td>
<td style="text-align: right;"><strong>0.9</strong></td>
<td style="text-align: right;"><span class="alert"><strong>2.9</strong></span></td>
</tr>
</tbody>
</table>
<h4 id="ケース1平均独立性times"><strong>ケース1：</strong>平均独立性<span class="math inline">\(\times\)</span></h4>
<ul>
<li>もし、現在の処置群が統制群になったら…
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 1]\)</span> = 0.9</li>
</ul></li>
<li>もし、現在の統制群が統制群になったら…（観察済）
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 0]\)</span> = 2.1</li>
</ul></li>
</ul>
<h4 id="ケース2平均独立性times"><strong>ケース2：</strong>平均独立性<span class="math inline">\(\times\)</span></h4>
<ul>
<li>もし、現在の処置群が処置群になったら…（観察済）
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 1]\)</span> = 2.9</li>
</ul></li>
<li>もし、現在の統制群が処置群になったら…
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 0]\)</span> = 4.1</li>
</ul></li>
</ul>
<!-- もし処置群と統制群が逆になったらATEの推定値は 4.1 - 0.9 = 3.2になる -->
</div></div>
</section>
<section id="x_i-0の場合" class="slide level2">
<h2><span class="math inline">\(X_i = 0\)</span>の場合</h2>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="oitvqnrcbn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oitvqnrcbn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oitvqnrcbn thead, #oitvqnrcbn tbody, #oitvqnrcbn tfoot, #oitvqnrcbn tr, #oitvqnrcbn td, #oitvqnrcbn th {
  border-style: none;
}

#oitvqnrcbn p {
  margin: 0;
  padding: 0;
}

#oitvqnrcbn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 24px;
  font-weight: normal;
  font-style: normal;
  background-color: rgba(255, 255, 255, 0);
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oitvqnrcbn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oitvqnrcbn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-bottom-width: 0;
}

#oitvqnrcbn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: rgba(255, 255, 255, 0);
  border-top-width: 0;
}

#oitvqnrcbn .gt_heading {
  background-color: rgba(255, 255, 255, 0);
  text-align: center;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oitvqnrcbn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oitvqnrcbn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oitvqnrcbn .gt_col_heading {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oitvqnrcbn .gt_column_spanner_outer {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oitvqnrcbn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oitvqnrcbn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oitvqnrcbn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oitvqnrcbn .gt_spanner_row {
  border-bottom-style: hidden;
}

#oitvqnrcbn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oitvqnrcbn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oitvqnrcbn .gt_from_md > :first-child {
  margin-top: 0;
}

#oitvqnrcbn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oitvqnrcbn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oitvqnrcbn .gt_stub {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oitvqnrcbn .gt_stub_row_group {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oitvqnrcbn .gt_row_group_first td {
  border-top-width: 2px;
}

#oitvqnrcbn .gt_row_group_first th {
  border-top-width: 2px;
}

#oitvqnrcbn .gt_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oitvqnrcbn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oitvqnrcbn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oitvqnrcbn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oitvqnrcbn .gt_grand_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oitvqnrcbn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oitvqnrcbn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oitvqnrcbn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oitvqnrcbn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oitvqnrcbn .gt_footnotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oitvqnrcbn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oitvqnrcbn .gt_sourcenotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oitvqnrcbn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oitvqnrcbn .gt_left {
  text-align: left;
}

#oitvqnrcbn .gt_center {
  text-align: center;
}

#oitvqnrcbn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oitvqnrcbn .gt_font_normal {
  font-weight: normal;
}

#oitvqnrcbn .gt_font_bold {
  font-weight: bold;
}

#oitvqnrcbn .gt_font_italic {
  font-style: italic;
}

#oitvqnrcbn .gt_super {
  font-size: 65%;
}

#oitvqnrcbn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oitvqnrcbn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oitvqnrcbn .gt_indent_1 {
  text-indent: 5px;
}

#oitvqnrcbn .gt_indent_2 {
  text-indent: 10px;
}

#oitvqnrcbn .gt_indent_3 {
  text-indent: 15px;
}

#oitvqnrcbn .gt_indent_4 {
  text-indent: 20px;
}

#oitvqnrcbn .gt_indent_5 {
  text-indent: 25px;
}

#oitvqnrcbn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oitvqnrcbn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="D">D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X">X</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y">Y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(0)">Y(0)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(1)">Y(1)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">-1</td>
<td headers="Y(0)" class="gt_row gt_right">-1</td>
<td headers="Y(1)" class="gt_row gt_right">1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">5</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">6</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">-1</td>
<td headers="Y(0)" class="gt_row gt_right">-3</td>
<td headers="Y(1)" class="gt_row gt_right">-1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">7</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">-2</td>
<td headers="Y(1)" class="gt_row gt_right">0</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">8</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">-1</td>
<td headers="Y(1)" class="gt_row gt_right">1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">9</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">2</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">10</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">0</td>
<td headers="Y" class="gt_row gt_right">3</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div><div class="column" style="width:75%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;"><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i, X_i = 0]\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i, X_i = 0]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_i = 0\)</span></td>
<td style="text-align: right;"><span class="alert"><strong>0.0</strong></span></td>
<td style="text-align: right;"><strong>2.0</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D_i = 1\)</span></td>
<td style="text-align: right;"><strong>0.0</strong></td>
<td style="text-align: right;"><span class="alert"><strong>2.0</strong></span></td>
</tr>
</tbody>
</table>
<h4 id="ケース1平均独立性bigcirc"><strong>ケース1：</strong>平均独立性<span class="math inline">\(\bigcirc\)</span></h4>
<ul>
<li>もし、現在の処置群が統制群になったら…
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 1]\)</span> = 0</li>
</ul></li>
<li>もし、現在の統制群が統制群になったら…（観察済）
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 0]\)</span> = 0</li>
</ul></li>
</ul>
<h4 id="ケース2平均独立性bigcirc"><strong>ケース2：</strong>平均独立性<span class="math inline">\(\bigcirc\)</span></h4>
<ul>
<li>もし、現在の処置群が処置群になったら…（観察済）
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 1]\)</span> = 2</li>
</ul></li>
<li>もし、現在の統制群が処置群になったら…
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 0]\)</span> = 2</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="x_i-1の場合" class="slide level2">
<h2><span class="math inline">\(X_i = 1\)</span>の場合</h2>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="xgecrvfops" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xgecrvfops table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xgecrvfops thead, #xgecrvfops tbody, #xgecrvfops tfoot, #xgecrvfops tr, #xgecrvfops td, #xgecrvfops th {
  border-style: none;
}

#xgecrvfops p {
  margin: 0;
  padding: 0;
}

#xgecrvfops .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 24px;
  font-weight: normal;
  font-style: normal;
  background-color: rgba(255, 255, 255, 0);
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xgecrvfops .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xgecrvfops .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-bottom-width: 0;
}

#xgecrvfops .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: rgba(255, 255, 255, 0);
  border-top-width: 0;
}

#xgecrvfops .gt_heading {
  background-color: rgba(255, 255, 255, 0);
  text-align: center;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgecrvfops .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgecrvfops .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgecrvfops .gt_col_heading {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xgecrvfops .gt_column_spanner_outer {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xgecrvfops .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xgecrvfops .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xgecrvfops .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xgecrvfops .gt_spanner_row {
  border-bottom-style: hidden;
}

#xgecrvfops .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xgecrvfops .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xgecrvfops .gt_from_md > :first-child {
  margin-top: 0;
}

#xgecrvfops .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xgecrvfops .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xgecrvfops .gt_stub {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xgecrvfops .gt_stub_row_group {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xgecrvfops .gt_row_group_first td {
  border-top-width: 2px;
}

#xgecrvfops .gt_row_group_first th {
  border-top-width: 2px;
}

#xgecrvfops .gt_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgecrvfops .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xgecrvfops .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xgecrvfops .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgecrvfops .gt_grand_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgecrvfops .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xgecrvfops .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xgecrvfops .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xgecrvfops .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgecrvfops .gt_footnotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgecrvfops .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgecrvfops .gt_sourcenotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgecrvfops .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgecrvfops .gt_left {
  text-align: left;
}

#xgecrvfops .gt_center {
  text-align: center;
}

#xgecrvfops .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xgecrvfops .gt_font_normal {
  font-weight: normal;
}

#xgecrvfops .gt_font_bold {
  font-weight: bold;
}

#xgecrvfops .gt_font_italic {
  font-style: italic;
}

#xgecrvfops .gt_super {
  font-size: 65%;
}

#xgecrvfops .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xgecrvfops .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xgecrvfops .gt_indent_1 {
  text-indent: 5px;
}

#xgecrvfops .gt_indent_2 {
  text-indent: 10px;
}

#xgecrvfops .gt_indent_3 {
  text-indent: 15px;
}

#xgecrvfops .gt_indent_4 {
  text-indent: 20px;
}

#xgecrvfops .gt_indent_5 {
  text-indent: 25px;
}

#xgecrvfops .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xgecrvfops div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="D">D</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X">X</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y">Y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(0)">Y(0)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Y(1)">Y(1)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">11</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">4</td>
<td headers="Y(1)" class="gt_row gt_right">6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">12</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">5</td>
<td headers="Y(1)" class="gt_row gt_right">7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">13</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">1</td>
<td headers="Y(0)" class="gt_row gt_right">1</td>
<td headers="Y(1)" class="gt_row gt_right">3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">14</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">0</td>
<td headers="Y(0)" class="gt_row gt_right">0</td>
<td headers="Y(1)" class="gt_row gt_right">2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">15</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">2</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">16</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">3</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">17</td>
<td headers="D" class="gt_row gt_right">0</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">6</td>
<td headers="Y(0)" class="gt_row gt_right">6</td>
<td headers="Y(1)" class="gt_row gt_right">8</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">18</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">4</td>
<td headers="Y(0)" class="gt_row gt_right">2</td>
<td headers="Y(1)" class="gt_row gt_right">4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">19</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">5</td>
<td headers="Y(0)" class="gt_row gt_right">3</td>
<td headers="Y(1)" class="gt_row gt_right">5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">20</td>
<td headers="D" class="gt_row gt_right">1</td>
<td headers="X" class="gt_row gt_right">1</td>
<td headers="Y" class="gt_row gt_right">6</td>
<td headers="Y(0)" class="gt_row gt_right">4</td>
<td headers="Y(1)" class="gt_row gt_right">6</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div><div class="column" style="width:75%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;"><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i, X_i = 1]\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i, X_i = 1]\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_i = 0\)</span></td>
<td style="text-align: right;"><span class="alert"><strong>3.0</strong></span></td>
<td style="text-align: right;"><strong>5.0</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D_i = 1\)</span></td>
<td style="text-align: right;"><strong>3.0</strong></td>
<td style="text-align: right;"><span class="alert"><strong>5.0</strong></span></td>
</tr>
</tbody>
</table>
<h4 id="ケース1平均独立性bigcirc-1"><strong>ケース1：</strong>平均独立性<span class="math inline">\(\bigcirc\)</span></h4>
<ul>
<li>もし、現在の処置群が統制群になったら…
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 1]\)</span> = 3</li>
</ul></li>
<li>もし、現在の統制群が統制群になったら…（観察済）
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 0]\)</span> = 3</li>
</ul></li>
</ul>
<h4 id="ケース2平均独立性bigcirc-1"><strong>ケース2：</strong>平均独立性<span class="math inline">\(\bigcirc\)</span></h4>
<ul>
<li>もし、現在の処置群が処置群になったら…（観察済）
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 1]\)</span> = 5</li>
</ul></li>
<li>もし、現在の統制群が処置群になったら…
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 0]\)</span> = 5</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="条件付き平均独立と回帰分析" class="slide level2">
<h2>条件付き平均独立と回帰分析</h2>
<p><span class="alert"><strong>条件付き平均独立が成立する場合、重回帰分析でバイアスのないATEが推定可能</strong></span></p>
<ul>
<li>CIAが成り立ったらさらに良い</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_4ds29k3aa37tg1vpxr3g(i, j, css_id) {
          var table = document.getElementById("tinytable_4ds29k3aa37tg1vpxr3g");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_4ds29k3aa37tg1vpxr3g');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_4ds29k3aa37tg1vpxr3g(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_4ds29k3aa37tg1vpxr3g");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 5, j: 1 }, { i: 5, j: 2 },  ], css_id: 'tinytable_css_dxyy803z947gy39wm6bx',}, 
          { positions: [ { i: 3, j: 2 }, { i: 3, j: 1 },  ], css_id: 'tinytable_css_nv8jnvxfq1zbuwg7lrz8',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 4, j: 1 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 4, j: 2 },  ], css_id: 'tinytable_css_l8silzr6lkoaar75d4eo',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_0uwsdsnh0kwld4o9eus2',}, 
          { positions: [ { i: 5, j: 0 },  ], css_id: 'tinytable_css_aulksnuncr0zrh15dwuy',}, 
          { positions: [ { i: 3, j: 0 },  ], css_id: 'tinytable_css_m11vwktn5tr1pa36d6tr',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 4, j: 0 },  ], css_id: 'tinytable_css_iujq0io2zfwct4tm6ctk',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_3k8prjnjldoms4r72chx',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_4ds29k3aa37tg1vpxr3g(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_dxyy803z947gy39wm6bx, .table th.tinytable_css_dxyy803z947gy39wm6bx { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_nv8jnvxfq1zbuwg7lrz8, .table th.tinytable_css_nv8jnvxfq1zbuwg7lrz8 { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_l8silzr6lkoaar75d4eo, .table th.tinytable_css_l8silzr6lkoaar75d4eo { text-align: center; }
      .table td.tinytable_css_0uwsdsnh0kwld4o9eus2, .table th.tinytable_css_0uwsdsnh0kwld4o9eus2 { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_aulksnuncr0zrh15dwuy, .table th.tinytable_css_aulksnuncr0zrh15dwuy { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_m11vwktn5tr1pa36d6tr, .table th.tinytable_css_m11vwktn5tr1pa36d6tr { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_iujq0io2zfwct4tm6ctk, .table th.tinytable_css_iujq0io2zfwct4tm6ctk { text-align: left; }
      .table td.tinytable_css_3k8prjnjldoms4r72chx, .table th.tinytable_css_3k8prjnjldoms4r72chx { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_4ds29k3aa37tg1vpxr3g" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">統制変数なし</th>
                <th scope="col">統制変数あり</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="3">注：カッコ内はHC2頑健標準誤差</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>切片</td>
                  <td>2.100 (0.737)</td>
                  <td>-0.000 (0.560)</td>
                </tr>
                <tr>
                  <td>D</td>
                  <td>0.800 (1.042)</td>
                  <td>2.000 (0.683)</td>
                </tr>
                <tr>
                  <td>X</td>
                  <td></td>
                  <td>3.000 (0.683)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>20</td>
                  <td>20</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.032</td>
                  <td>0.406</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<ul>
<li>統制変数<strong>なし</strong>（単回帰分析）のATEの推定値：0.8
<ul>
<li>処置群と統制群を交換する場合、ATEの推定値は3.2</li>
</ul></li>
<li>統制変数<strong>あり</strong>（重回帰分析）のATEの推定値：2.0
<ul>
<li>{<span class="math inline">\(X_i = 0\)</span>におけるATE} = {<span class="math inline">\(X_i = 1\)</span>におけるATE} = 2</li>
<li><span class="math inline">\(X_i = x\)</span>で処置群と統制群を交換してもATEの推定値は2</li>
</ul></li>
</ul>
</section>
<section id="cia条件付き平均独立性は確認可能か" class="slide level2">
<h2>CIA/条件付き平均独立性は確認可能か</h2>
<p>条件付き平均独立性</p>
<p><span class="math display">\[
\mathbb{E}[Y_i(1)|D_i = 1, X_i = x] = \mathbb{E}[Y_i(1)|D_i = 0, X_i = x] = \mathbb{E}[Y_i(1)|X_i = x]
\]</span></p>
<center>
かつ
</center>
<p><span class="math display">\[
\mathbb{E}[Y_i(0)|D_i = 1, X_i = x] = \mathbb{E}[Y_i(0)|D_i = 0, X_i = x] = \mathbb{E}[Y_i(0)|X_i = x]
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbb{E}[Y_i(1)|D_i = 0, X_i = x]\)</span>、<span class="math inline">\(\mathbb{E}[Y_i(0)|D_i = 1, X_i = x]\)</span>は観察不可
<ul>
<li><span class="math inline">\(\Rightarrow\)</span> <span class="alert"><strong>平均独立性が成り立っているかどうかは確認できない</strong></span>
<ul>
<li>平均独立性よりも厳しいCIAの確認はさらに難しい</li>
</ul></li>
<li>「Xで条件付ければ平均独立性が成り立つだろう」と仮定するしかない</li>
<li><span class="alert">非実験データ</span>であれば、変数選択&amp;モデリングを慎重に行う必要がある</li>
</ul></li>
<li>もし、間違った条件付けをしてしまったら…?</li>
</ul>
</section></section>
<section>
<section id="欠落変数バイアス" class="title-slide slide level1 center">
<h1><strong>3</strong> 欠落変数バイアス</h1>

</section>
<section id="欠落変数バイアスの定式化" class="slide level2">
<h2>欠落変数バイアスの定式化</h2>
<ul>
<li>3つのモデル（真の処置効果は<span class="math inline">\(\tau^l\)</span>）
<ul>
<li>真のモデル（long regression）：<span class="math inline">\(Y_i = \alpha^l + \tau^l D_i + \beta^l X_i + \varepsilon_i\)</span></li>
<li>バイアス付きのモデル（short regression）：<span class="math inline">\(Y_i = \alpha^s + \tau^s D_i + \zeta_i\)</span></li>
<li>XをDに回帰したモデル：<span class="math inline">\(X_i = \alpha_0 + \lambda D_i + \nu_i\)</span></li>
</ul></li>
</ul>
<h3 id="真のモデルからxが消えたら"><strong>真のモデルからXが消えたら…</strong></h3>
<p><span class="math display">\[
\begin{align}
Y_i &amp; = \alpha^l + \tau^l D_i + \beta^l X_i + \varepsilon_i \\
&amp; = \alpha^l + \tau^l D_i + \beta^l (\alpha_0 + \lambda D_i + \nu_i) + \varepsilon_i \\
&amp; = \alpha^l + \tau^l D_i + \beta^l\alpha_0 + \beta^l \lambda D_i + \beta^l \nu_i + \varepsilon_i \\
&amp; = \underbrace{(\alpha^l + \beta^l\alpha_0)}_{\alpha^s} + \underbrace{(\tau^l + \beta^l \lambda)}_{\tau^s} D_i + \underbrace{(\varepsilon_i + \beta^l \nu_i)}_{\varepsilon_i}
\end{align}
\]</span></p>
</section>
<section id="欠落変数バイアス-1" class="slide level2">
<h2>欠落変数バイアス</h2>
<p><span class="alert"><strong>欠落変数バイアス</strong></span>（omitted variable bias; <span class="alert"><strong>OVB</strong></span>）</p>
<ul>
<li><span class="math inline">\(\beta^l\)</span>：X <span class="math inline">\(\rightarrow\)</span> Yの係数</li>
<li><span class="math inline">\(\lambda\)</span>：D <span class="math inline">\(\rightarrow\)</span> Xの係数</li>
</ul>
<p><span class="math display">\[
\underbrace{\tau^s}_{\textsf{バイアス付きの推定値}} = \underbrace{\tau^l}_{\textsf{真の処置効果}} + \underbrace{\textcolor{red}{\beta^l \lambda}}_{\textsf{欠落変数バイアス}}
\]</span></p>
<ul>
<li><span class="math inline">\(\beta^l = 0\)</span>、または<span class="math inline">\(\lambda = 0\)</span>ならOVBは発生しない</li>
<li><span class="math inline">\(\beta^l \neq 0\)</span>、かつ<span class="math inline">\(\lambda \neq 0\)</span>の場合、Xは<span class="alert"><strong>交絡要因</strong></span>（confounder）である。
<ul>
<li><span class="alert"><strong>交絡要因を統制しないと、OVBが発生する</strong></span></li>
</ul></li>
</ul>
</section>
<section id="欠落変数バイアスの可視化1" class="slide level2">
<h2>欠落変数バイアスの可視化（1）</h2>
<p>職業訓練（D）は将来の年収（Y）にどのような影響を与えるか</p>
<ul>
<li>負の効果?効果なし?内生性（自己選択）は?</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-15-2.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="欠落変数バイアスの可視化2" class="slide level2">
<h2>欠落変数バイアスの可視化（2）</h2>
<p>交絡要因として職業訓練前の年収（X）</p>
<ul>
<li>職業訓練前の年収を考慮したモデル：実は正の効果があるかも?</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-16-2.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="処置後変数バイアス" class="title-slide slide level1 center">
<h1><strong>4</strong> 処置後変数バイアス</h1>

</section>
<section id="処置後変数とは" class="slide level2">
<h2>処置後変数とは</h2>
<p><span class="alert"><strong>処置後変数</strong></span>（post-treatment variable）</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center" width="900"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<ul>
<li>XはDの処置後変数
<ul>
<li>XがYに直接与える処置効果（直接効果）</li>
<li>XはDを経由してYに与える処置効果（間接効果）</li>
<li>総効果 = 直接効果 + 間接効果</li>
</ul></li>
<li>因果推論において主に注目するのは<span class="alert">総効果</span>
<ul>
<li>この場合、Xを統制してはいけない</li>
<li>説明変数がDのみの単回帰分析を採用すべき</li>
</ul></li>
</ul>
</div></div>

<aside><div>
<p>参考）XがYに与える影響を推定したい場合、Dを統制すべきである。なぜならXを処置変数と考えると、Dは交絡要因になるからだ。</p>
</div></aside></section>
<section id="処置後変数バイアス-1" class="slide level2">
<h2>処置後変数バイアス</h2>
<ul>
<li><span class="math inline">\(Y_i = \alpha^p + \tau^p D_i + \beta^p X_i + \varepsilon_i^p\)</span></li>
<li><span class="math inline">\(X_i = \alpha_0 + \lambda D_i + \nu_i\)</span></li>
</ul>
<p><span class="math display">\[
\begin{align}
Y_i &amp; = \alpha^p + \tau^p D_i + \beta^p X_i + \varepsilon_i^p \\
&amp; = \alpha^p + \tau^p D_i + \beta^p (\alpha_0 + \lambda D_i + \nu_i) + \varepsilon_i^p \\
&amp; = \alpha^p + \tau^p D_i + \beta^p \alpha_0 + \beta^p \lambda D_i + \beta^p \nu_i + \varepsilon_i^p \\
&amp; = (\alpha^p + \beta^p \alpha_0) + \textcolor{red}{(\tau^p + \beta^p \lambda)} D_i + (\beta^p \nu_i + \varepsilon_i^p)
\end{align}
\]</span></p>
<ul>
<li>YをDのみに回帰した場合の処置効果：<span class="math inline">\(\tau^p + \beta^p \lambda\)</span>（=<span class="alert"><strong>真の処置効果</strong></span>）
<ul>
<li>Xがモデル含まれている場合の処置効果の推定値：<span class="math inline">\(\tau^p\)</span></li>
<li><span class="alert">処置後変数バイアス：<span class="math inline">\(-\beta^p \lambda\)</span></span></li>
</ul></li>
<li><span class="math inline">\(\lambda\)</span>か<span class="math inline">\(\beta^p\)</span>が0なら、処置後変数バイアスは発生しない
<ul>
<li><span class="math inline">\(\lambda\)</span> = 0なら、そもそもXはDの処置後変数ではない</li>
</ul></li>
</ul>
</section>
<section id="直接効果間接効果総効果" class="slide level2">
<h2>直接効果、間接効果、総効果</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>直接効果：<span class="math inline">\(\tau^p\)</span></p></li>
<li><p>間接効果：<span class="math inline">\(\lambda \times \beta^p\)</span></p>
<ul>
<li>Dが1単位上がると、Xが<span class="math inline">\(\lambda\)</span>分増加するため</li>
</ul></li>
<li><p>総効果：<span class="math inline">\(\tau^p + \lambda \beta^p\)</span></p></li>
<li><p>YをDとXに回帰する場合、得られる推定量</p>
<ul>
<li>直接効果（<span class="math inline">\(\tau^p\)</span>）と間接効果の一部（<span class="math inline">\(\beta^p\)</span>）</li>
</ul></li>
<li><p>YをDのみに回帰する場合、得られる推定量</p>
<ul>
<li>総効果（<span class="math inline">\(\tau^p + \lambda \beta^p\)</span>）</li>
</ul></li>
</ul>
</div></div>
</section></section>
<section>
<section id="変数選択" class="title-slide slide level1 center">
<h1><strong>5</strong> 変数選択</h1>

</section>
<section id="dag" class="slide level2">
<h2>DAG</h2>
<p><span class="alert"><strong>有向非巡回グラフ</strong></span>（Directed acyclic graph, <span class="alert"><strong>DAG</strong></span>）</p>
<ul>
<li>サイクルが存在しない有向グラフ（無向グラフは常にサイクルが存在）
<ul>
<li>右グラフはサイクルが存在（D <span class="math inline">\(\rightarrow\)</span> Y <span class="math inline">\(\rightarrow\)</span> X <span class="math inline">\(\rightarrow\)</span> D <span class="math inline">\(\rightarrow\)</span> Y <span class="math inline">\(\rightarrow\)</span>…）</li>
</ul></li>
<li><span class="alert">ノード</span>（点; node or vertex）と<span class="alert">エッジ</span>（線; edge）で構成</li>
<li>因果推論での活用（詳細は<a href="https://amzn.asia/d/iRY9OPO">Pearl et al.&nbsp;[2016=2019]</a>などを参照）</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-19-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="バックドア経路" class="slide level2">
<h2>バックドア経路</h2>
<p><span class="alert"><strong>バックドア経路</strong></span>（backdoor path）：原因と結果（DとY）両方にたどり着ける経路</p>
<ul>
<li>左：バックドア経路が存在（D <span class="math inline">\(\leftarrow\)</span> <span class="alert"><strong>X</strong></span> <span class="math inline">\(\rightarrow\)</span> W <span class="math inline">\(\rightarrow\)</span> Y）</li>
<li>右：バックドア経路が存在しない</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-20-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="分岐点" class="slide level2">
<h2>分岐点</h2>
<p><span class="alert"><strong>分岐点</strong></span>（counfounder）：原因（D）と結果（Y）両方にたどり着ける変数</p>
<ul>
<li>左：Xが分岐点（D <span class="math inline">\(\leftarrow\)</span> <span class="tomato"><strong>X</strong></span> <span class="math inline">\(\rightarrow\)</span> W <span class="math inline">\(\rightarrow\)</span> Y）</li>
<li>右：分岐点が存在しない</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-21-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="分岐点への対処" class="slide level2">
<h2>分岐点への対処</h2>
<p>バックドア経路が存在する場合、バックドア経路上の変数をモデルに投入</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-22-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>経路上の全変数を統制する必要はない
<ul>
<li>バックドア経路さえ無くせば良い</li>
<li>経路上のすべての変数がなくても良い</li>
</ul></li>
<li>どのモデルでも<span class="math inline">\(\bigcirc\)</span>
<ul>
<li>Xのみ統制</li>
<li>Wのみ統制</li>
<li>XとW両方統制</li>
</ul></li>
<li>バックドア経路が開いたままだと、<span class="alert">欠落変数バイアス</span>が発生</li>
</ul>
</div></div>
</section>
<section id="合流点" class="slide level2">
<h2>合流点</h2>
<p><span class="alert"><strong>合流点</strong></span>（collider）：原因（D）と結果（Y）両方からたどり着ける変数</p>
<ul>
<li>左：合流点が存在しない（バックドアはある）</li>
<li>右：Wが合流点（D <span class="math inline">\(\rightarrow\)</span> X <span class="math inline">\(\rightarrow\)</span> <span class="tomato"><strong>W</strong></span> <span class="math inline">\(\leftarrow\)</span> Y）</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-23-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-23-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="中間点" class="slide level2">
<h2>中間点</h2>
<p><span class="alert"><strong>中間点</strong></span>（mediator）：原因（D）から結果（Y）へ向かう経路上に存在する変数</p>
<ul>
<li>左：中間点が存在しない（バックドアはある）</li>
<li>右：XとWが中間点（D <span class="math inline">\(\rightarrow\)</span> <span class="tomato"><strong>X</strong></span> <span class="math inline">\(\rightarrow\)</span> <span class="tomato"><strong>W</strong></span> <span class="math inline">\(\rightarrow\)</span> Y）</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-24-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="合流点中間点への対処" class="slide level2">
<h2>合流点・中間点への対処</h2>
<p>合流点、中間点はいずれも<span class="alert"><strong>処置後変数</strong></span>（処置後変数バイアスの原因）</p>
<ul>
<li>モデルに投入すると新しいバックドア経路が開く（右はXを統制した例）</li>
<li><span class="math inline">\(\Rightarrow\)</span> 合流点と中間点はモデルに投入しない！</li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-25-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-25-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="応用" class="slide level2">
<h2>応用</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>バックドア経路は計2つ</p>
<ul>
<li>D <span class="math inline">\(\leftarrow\)</span> <span class="tomato"><strong>W</strong></span> <span class="math inline">\(\rightarrow\)</span> <span class="tomato"><strong>V</strong></span> <span class="math inline">\(\rightarrow\)</span> Y</li>
<li>D <span class="math inline">\(\leftarrow\)</span> <span class="tomato"><strong>X</strong></span> <span class="math inline">\(\rightarrow\)</span> Y</li>
<li>2つの経路すべてを閉じる
<ul>
<li><span class="alert">{W, X}</span>か<span class="alert">{V, X}</span>、{W, V, X}を統制</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="rパッケージ" class="slide level2">
<h2>Rパッケージ</h2>
<p>DAGの作成および変数選択のためのRパッケージ</p>
<ul>
<li>{<a href="https://cran.r-project.org/web/packages/dagitty/index.html">dagitty</a>}</li>
<li>{<a href="https://r-causal.github.io/ggdag/">ggdag</a>}</li>
</ul>
</section>
<section id="dagの書き方" class="slide level2">
<h2>DAGの書き方</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>my_dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb1-2"><a></a>  Y <span class="sc">~</span> D <span class="sc">+</span> V <span class="sc">+</span> X <span class="sc">+</span> P <span class="sc">+</span> Q,</span>
<span id="cb1-3"><a></a>  V <span class="sc">~</span> W,</span>
<span id="cb1-4"><a></a>  D <span class="sc">~</span> W <span class="sc">+</span> X <span class="sc">+</span> Z,</span>
<span id="cb1-5"><a></a>  U <span class="sc">~</span> D <span class="sc">+</span> Y,</span>
<span id="cb1-6"><a></a>  Q <span class="sc">~</span> D,</span>
<span id="cb1-7"><a></a>  <span class="at">exposure =</span> <span class="st">"D"</span>,</span>
<span id="cb1-8"><a></a>  <span class="at">outcome  =</span> <span class="st">"Y"</span>,</span>
<span id="cb1-9"><a></a>  <span class="at">coords =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Y"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"D"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"W"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"V"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"X"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Z"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"P"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"U"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Q"</span> <span class="ot">=</span> <span class="dv">1</span>),</span>
<span id="cb1-10"><a></a>                <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"Y"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"D"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"W"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"V"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"X"</span> <span class="ot">=</span> <span class="fl">0.75</span>, <span class="st">"Z"</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">"P"</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">"U"</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">"Q"</span> <span class="ot">=</span> <span class="fl">1.5</span>))</span>
<span id="cb1-11"><a></a>)</span>
<span id="cb1-12"><a></a></span>
<span id="cb1-13"><a></a><span class="fu">ggdag</span>(my_dag) <span class="sc">+</span> <span class="fu">theme_dag</span>()</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="reg_slide_files/figure-html/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center r-stretch" width="2400"></section>
<section id="統制変数の提案" class="slide level2">
<h2>統制変数の提案</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>my_dag <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a></a>  <span class="fu">ggdag_adjustment_set</span>(<span class="at">shadow =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb2-3"><a></a>  <span class="fu">theme_dag</span>()</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="reg_slide_files/figure-html/unnamed-chunk-28-1.png" class="quarto-figure quarto-figure-center r-stretch" width="2400"></section></section>
<section>
<section id="交互作用" class="title-slide slide level1 center">
<h1><strong>6</strong> 交互作用</h1>

</section>
<section id="交互作用とは" class="slide level2">
<h2>交互作用とは</h2>
<p><span class="alert"><strong>交互作用</strong></span>（Interaction）：D <span class="math inline">\(\rightarrow\)</span> Yの影響がXの値に依存する</p>
<ul>
<li>左：Xが交絡要因・分岐点（confounder）</li>
<li>右：Xが<span class="alert">調整変数</span>（mediator）<sup>1</sup></li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-29-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-29-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn3"><p>DAGにおけるエッジはノードとノードを繋ぐ役割だけを果たすため、このような表記はできなが、便宜上、右の図のように表現している。実際、DAGで効果修飾（effect modification）は表現できない。つまり、右の図はDAGではない。</p></li></ol></aside></section>
<section id="交互作用の例" class="slide level2">
<h2>交互作用の例</h2>
<p>Dの処置効果がXに値によって異なる場合</p>
<ul>
<li><span class="alert">不均一な処置効果</span>（heterogeneous treatment effect）
<ul>
<li>または<span class="alert">条件付きATE</span>（conditional average treatment effect; <span class="alert"><strong>CATE</strong></span>）</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>例）薬の効き目が性別によって異なる
<ul>
<li>直線は単回帰分析に基づく回帰直線</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center" width="1500"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="交互作用のモデリング" class="slide level2">
<h2>交互作用のモデリング</h2>
<p>通常の重回帰モデルに<span class="alert"><strong>交差項</strong></span>（interaction term）を投入</p>
<ul>
<li>交差項：2つ以上の変数の<strong>積</strong>（以下の<span class="math inline">\(D_i X_i\)</span>）</li>
<li>DとXの交互作用なし：<span class="math inline">\(Y_i = \alpha + \tau D_i + \beta X_i + \varepsilon_i\)</span></li>
<li>DとXの交互作用あり：<span class="math inline">\(Y_i = \alpha + \tau D_i + \beta X_i~ +\)</span> <span class="alert"><span class="math inline">\(\gamma D_i X_i\)</span></span> <span class="math inline">\(+~ \varepsilon_i\)</span></li>
</ul>
</section>
<section id="重回帰分析との比較図" class="slide level2">
<h2>重回帰分析との比較（図）</h2>
<ul>
<li>重回帰分析（左）：男女の<span class="alert">傾きが同じ</span></li>
<li>交互作用モデル（右）：男女の<span class="alert"><strong>傾きが異なる</strong></span></li>
</ul>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-31-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-31-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="重回帰分析との比較表" class="slide level2">
<h2>重回帰分析との比較（表）</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="wzkmwbxbgr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wzkmwbxbgr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wzkmwbxbgr thead, #wzkmwbxbgr tbody, #wzkmwbxbgr tfoot, #wzkmwbxbgr tr, #wzkmwbxbgr td, #wzkmwbxbgr th {
  border-style: none;
}

#wzkmwbxbgr p {
  margin: 0;
  padding: 0;
}

#wzkmwbxbgr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 24px;
  font-weight: normal;
  font-style: normal;
  background-color: rgba(255, 255, 255, 0);
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wzkmwbxbgr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wzkmwbxbgr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-bottom-width: 0;
}

#wzkmwbxbgr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: rgba(255, 255, 255, 0);
  border-top-width: 0;
}

#wzkmwbxbgr .gt_heading {
  background-color: rgba(255, 255, 255, 0);
  text-align: center;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wzkmwbxbgr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzkmwbxbgr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wzkmwbxbgr .gt_col_heading {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wzkmwbxbgr .gt_column_spanner_outer {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wzkmwbxbgr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wzkmwbxbgr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wzkmwbxbgr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wzkmwbxbgr .gt_spanner_row {
  border-bottom-style: hidden;
}

#wzkmwbxbgr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wzkmwbxbgr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wzkmwbxbgr .gt_from_md > :first-child {
  margin-top: 0;
}

#wzkmwbxbgr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wzkmwbxbgr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wzkmwbxbgr .gt_stub {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wzkmwbxbgr .gt_stub_row_group {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wzkmwbxbgr .gt_row_group_first td {
  border-top-width: 2px;
}

#wzkmwbxbgr .gt_row_group_first th {
  border-top-width: 2px;
}

#wzkmwbxbgr .gt_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzkmwbxbgr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wzkmwbxbgr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wzkmwbxbgr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzkmwbxbgr .gt_grand_summary_row {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzkmwbxbgr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wzkmwbxbgr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wzkmwbxbgr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wzkmwbxbgr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzkmwbxbgr .gt_footnotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wzkmwbxbgr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzkmwbxbgr .gt_sourcenotes {
  color: #333333;
  background-color: rgba(255, 255, 255, 0);
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wzkmwbxbgr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzkmwbxbgr .gt_left {
  text-align: left;
}

#wzkmwbxbgr .gt_center {
  text-align: center;
}

#wzkmwbxbgr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wzkmwbxbgr .gt_font_normal {
  font-weight: normal;
}

#wzkmwbxbgr .gt_font_bold {
  font-weight: bold;
}

#wzkmwbxbgr .gt_font_italic {
  font-style: italic;
}

#wzkmwbxbgr .gt_super {
  font-size: 65%;
}

#wzkmwbxbgr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wzkmwbxbgr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wzkmwbxbgr .gt_indent_1 {
  text-indent: 5px;
}

#wzkmwbxbgr .gt_indent_2 {
  text-indent: 10px;
}

#wzkmwbxbgr .gt_indent_3 {
  text-indent: 15px;
}

#wzkmwbxbgr .gt_indent_4 {
  text-indent: 20px;
}

#wzkmwbxbgr .gt_indent_5 {
  text-indent: 25px;
}

#wzkmwbxbgr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wzkmwbxbgr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="a交互作用なし">交互作用なし</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="a交互作用あり">交互作用あり</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">切片</td>
<td headers="交互作用なし" class="gt_row gt_center">35.835 (0.245)</td>
<td headers="交互作用あり" class="gt_row gt_center">36.419 (0.329)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">投薬量</td>
<td headers="交互作用なし" class="gt_row gt_center">0.010 (0.004)</td>
<td headers="交互作用あり" class="gt_row gt_center" style="background-color: #CCCCCC; color: #000000;">-0.002 (0.006)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">男性ダミー</td>
<td headers="交互作用なし" class="gt_row gt_center">1.584 (0.221)</td>
<td headers="交互作用あり" class="gt_row gt_center">0.442 (0.438)</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">投薬量:男性ダミー</td>
<td headers="交互作用なし" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="交互作用あり" class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">0.023 (0.007)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="交互作用なし" class="gt_row gt_center">100</td>
<td headers="交互作用あり" class="gt_row gt_center">100</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="交互作用なし" class="gt_row gt_center">0.377</td>
<td headers="交互作用あり" class="gt_row gt_center">0.436</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2 Adj.</td>
<td headers="交互作用なし" class="gt_row gt_center">0.365</td>
<td headers="交互作用あり" class="gt_row gt_center">0.418</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="3">注：カッコ内はHC2頑健標準誤差</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<ul>
<li><strong>係数の解釈：</strong>他の条件が同じであれば投薬量が1単位（= 1mg）増えると体温の期待値は0.002単位（0.002℃）下がる
<ul>
<li>これで大丈夫?</li>
<li>何か忘れていませんか?<span class="alert">回帰式に処置変数（投薬量）は2回登場する</span>はず</li>
</ul></li>
</ul>
</section>
<section id="交互作用の解釈" class="slide level2">
<h2>交互作用の解釈</h2>
<p>処置効果は<span class="math inline">\(\tau\)</span>でなく、<span class="alert"><span class="math inline">\(\tau + \gamma X_i\)</span></span></p>
<p><span class="math display">\[
\begin{align}
Y_i &amp; = \alpha + \tau D_i + \beta X_i + \gamma D_i X_i + \varepsilon_i \\
&amp; = \alpha + (\tau + \gamma X_i) D_i + \beta X_i + \varepsilon_i
\end{align}
\]</span></p>
<ul>
<li><span class="math inline">\(X_i = 0\)</span>の時の処置効果、<span class="math inline">\(X_i = 1\)</span>の時の処置効果、<span class="math inline">\(X_i = 3\)</span>の時の処置効果、…
<ul>
<li><span class="alert"><strong>限界効果</strong></span>（marginal effect）</li>
</ul></li>
<li><span class="alert">交互作用は<strong>予測値</strong>と<strong>限界効果</strong>に基づいて解釈すべき</span>（回帰係数にこだわらない）</li>
<li>詳細は<a href="https://doi.org/10.1093/pan/mpi014">Brambor（2006）</a>を参照</li>
</ul>

<aside><div>
<p>Brambor, Thomas, William Roberts Clark, and Matt Golder. 2006. “<a href="https://doi.org/10.1093/pan/mpi014">Understanding Interaction Models: Improving Empirical Analyses</a>.” <em>Political Analysis,</em> 14(1): 63–82.</p>
</div></aside></section>
<section id="予測値左と限界効果右" class="slide level2">
<h2>予測値（左）と限界効果（右）</h2>
<p>男性の場合、投薬量が1mg増えると体温は約0.02℃上がる。一方、女性の場合、統計的有意な処置効果は確認できない<sup>1</sup>。</p>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-33-2.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn4"><p>「処置効果はない」と解釈してはいけない。伝統的な統計的仮説検定において帰無仮説が正しいことは示せないからだ。</p></li></ol></aside></section></section>
<section>
<section id="実装" class="title-slide slide level1 center">
<h1><strong>7</strong> 実装</h1>

</section>
<section id="推定" class="slide level2">
<h2>推定</h2>
<h4 id="共通"><strong>共通</strong></h4>
<ul>
<li>予測値、効果量を示すことで実質科学的な議論を</li>
<li>交差項を含むモデルの場合、限界効果も示すこと</li>
</ul>
<h4 id="実験データの場合"><strong>実験データの場合</strong></h4>
<ul>
<li>処置変数は外生変数（の可能性が非常に高い）であるため、統制変数は不要
<ul>
<li>実験でも処置の自己選択が生じるケースもあるため、統制変数が必要な場合も</li>
</ul></li>
<li>統制変数を入れても良い
<ul>
<li><i class="bi bi-emoji-smile"></i> 標準誤差が小さくなる</li>
<li><i class="bi bi-emoji-dizzy"></i> 処置後変数は投入しない!</li>
</ul></li>
</ul>
<h4 id="観察データの場合"><strong>観察データの場合</strong></h4>
<ul>
<li>処置変数は内生変数（の可能性が非常に高い）であるため、統制変数が必要</li>
<li>慎重な変数選択が必要</li>
</ul>
</section>
<section id="実験データと重回帰分析" class="slide level2">
<h2>実験データと重回帰分析</h2>
<ul>
<li>Freedman（2008a, 2008b）の問題提起
<ul>
<li>内生性の問題が多く解決されているはずの実験データであっても、共変量調整は場合によって<span class="alert">精度の低下、バイアスの導入、信頼できない標準誤差の原因</span>になる</li>
</ul></li>
<li>Lin（2013）の提案
<ul>
<li>Freedmanの議論は正しいが、以下の2つを採用することで解決可能（大標本を前提とする）</li>
</ul>
<ol type="1">
<li>処置変数と共変量間の交差項を投入（共変量が複数なら<strong>すべて</strong>の共変量との交差項を投入）</li>
<li>頑健標準誤差<span class="small">（Huber–White sandwich standard error）</span>を使用</li>
</ol></li>
</ul>

<aside><div>
<ul>
<li>Freedman, David A. 2008a. “<a href="https://doi.org/10.1214/07-AOAS143">On Regression Adjustments in Experiments with Several Treatments</a>.” <em>The Annals of Applied Statistics.</em> 2(1): 176-96.</li>
<li>Freedman, David A. 2008b. “<a href="https://doi.org/10.1214/08-STS262">Randomization Does Not Justify Logistic Regression</a>.” <em>Statistical Science.</em> 23(2): 237-249.</li>
<li>Lin, Winston. 2013. “<a href="https://doi.org/10.1214/12-AOAS583">Agnostic Notes on Regression Adjustments to Experimental Data: Reexamining Freedman’s Critique</a>.” <em>The Annals of Applied Statistics</em> 7(1): 295-318.</li>
</ul>
</div></aside></section>
<section id="効果量" class="slide level2">
<h2>効果量</h2>
<p>処置効果の大きさを数値化し、評価する（<span class="alert"><strong>ドメイン知識</strong></span>が必要）</p>
<ul>
<li>統制群と処置群間の結果変数の差
<ul>
<li><span class="alert">差</span>はいくらか、または<span class="alert">何SD分</span>かなど</li>
</ul></li>
<li>処置変数が連続の場合は、最小値 <span class="math inline">\(\rightarrow\)</span> 最大値、平均を中心とした <span class="math inline">\(\pm\)</span> 1 or 2SDなど</li>
</ul>
<p>心理学を中心とした効果量の議論</p>
<ul>
<li>Standardized mean difference</li>
<li>Cohen’s <em>d</em></li>
</ul>
</section>
<section id="効果量の例cohens-d" class="slide level2">
<h2>効果量の例：Cohen’s <em>d</em></h2>
<p>幅広く使われる効果量（<a href="https://amzn.asia/d/f1tdgqC">Cohen 1980</a>）</p>
<ul>
<li><span class="math inline">\(s_{\cdot}^2\)</span>は不偏分散</li>
</ul>
<p><span class="math display">\[
\begin{align}
d &amp; = \frac{\bar{x}_1 - \bar{x}_2}{s} \\
s &amp; = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
\end{align}
\]</span></p>
<p><a href="https://amzn.asia/d/f1tdgqC">Cohen（1980）</a>の基準（すべての学問分野に適用される基準ではない）</p>
<ul>
<li>小さい効果量：<em>d</em> = 0.2</li>
<li>中程度の効果量：<em>d</em> = 0.5</li>
<li>大きい効果量：<em>d</em> = 0.8</li>
</ul>

<aside><div>
<ul>
<li>Cohen, Jacob. 1988. <a href="https://amzn.asia/d/f1tdgqC"><em>Statistical Power Analysis for the Behavioral Sciences</em></a>. Routledge.</li>
</ul>
</div></aside></section>
<section id="統制変数の解釈について" class="slide level2">
<h2>統制変数の解釈について</h2>
<p>基本的に統制変数の係数は<span class="alert">解釈しない</span></p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="reg_slide_files/figure-html/unnamed-chunk-34-1.png" class="quarto-figure quarto-figure-center" width="1200"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>信頼できる<span class="math inline">\(\tau\)</span>を推定するために、分岐点（交絡要因）であるXを統制</p>
<ul>
<li><span class="math inline">\(\tau\)</span>：DがYに与える効果</li>
<li><span class="math inline">\(\beta\)</span>：XがYに与える効果?
<ul>
<li>X <span class="math inline">\(\rightarrow\)</span> Yの関係においてDは中間点（媒介変数）</li>
<li><span class="alert">中間点は統制しない</span>のが原則</li>
<li>XがYに与える効果を推定するためにはモデルからDを除外すべき</li>
</ul></li>
</ul>
</div></div>



<aside><div>
<ul>
<li>「Dが同じ場合、XがYに与える効果」（= XからYへの直接効果）を推定する場合、DとX両方を投入したモデルは正しい。しかし、Xが変わるとDが必ず変わるため、「Dを固定したら…」という前提はそもそも現実的ではない。</li>
</ul>
</div></aside></section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>回帰分析</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "コピーしました");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "コピーしました");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>